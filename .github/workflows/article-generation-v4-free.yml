name: Article Generation V4 Free (Simplified Output)

on:
  workflow_dispatch:
    inputs:
      article_title:
        description: 'ã‚¿ã‚¤ãƒˆãƒ«æ¡ˆï¼ˆ30ã€œ32å­—ï¼‰'
        required: true
        type: string
        default: ''
      
      main_keywords:
        description: 'ä¸»è¦KWï¼ˆæœ€å¤§3èªã€ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰'
        required: true
        type: string
        default: ''
      
      approach_target:
        description: 'åˆ‡ã‚Šå£ãƒ»ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ'
        required: true
        type: string
        default: ''
      
      eeat_elements:
        description: 'E-E-A-Tè¦ç´ ï¼ˆExperience, Expertise, Authoritativeness, Trustworthinessï¼‰'
        required: true
        type: string
        default: ''
      
      word_count:
        description: 'ç›®æ¨™æ–‡å­—æ•°'
        required: false
        type: string
        default: '3200'
      
      enable_image_generation:
        description: 'ç”»åƒç”Ÿæˆã‚’æœ‰åŠ¹ã«ã™ã‚‹'
        required: false
        type: boolean
        default: true
      
      # Google Drive upload removed

env:
  PYTHON_VERSION: '3.11'

jobs:
  # ã‚¸ãƒ§ãƒ–1: åˆæœŸåŒ–
  initialize:
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 5
    outputs:
      article_id: ${{ steps.init.outputs.article_id }}
      
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Initialize article generation
        id: init
        run: |
          # ã‚¿ã‚¤ãƒˆãƒ«ã‹ã‚‰IDã‚’ç”Ÿæˆ
          CLEAN_TITLE=$(echo "${{ inputs.article_title }}" | sed 's/[^a-zA-Z0-9ã‚-ã‚“ã‚¢-ãƒ³ä¸€-é¾¯]/_/g' | cut -c1-50)
          ARTICLE_ID=$(date +%Y%m%d_%H%M%S)_${CLEAN_TITLE}
          echo "article_id=${ARTICLE_ID}" >> $GITHUB_OUTPUT
          echo "Article ID: ${ARTICLE_ID}"
          
          # å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
          mkdir -p output/${ARTICLE_ID}
          
          # å…¥åŠ›æƒ…å ±ã‚’ä¿å­˜
          TIMESTAMP=$(date -u +%Y-%m-%dT%H:%M:%SZ)
          echo '{' > "output/${ARTICLE_ID}/input_params.json"
          echo "  \"article_id\": \"${ARTICLE_ID}\"," >> "output/${ARTICLE_ID}/input_params.json"
          echo "  \"title\": \"${{ inputs.article_title }}\"," >> "output/${ARTICLE_ID}/input_params.json"
          echo "  \"approach_target\": \"${{ inputs.approach_target }}\"," >> "output/${ARTICLE_ID}/input_params.json"
          echo "  \"main_keywords\": \"${{ inputs.main_keywords }}\"," >> "output/${ARTICLE_ID}/input_params.json"
          echo "  \"eeat_elements\": \"${{ inputs.eeat_elements }}\"," >> "output/${ARTICLE_ID}/input_params.json"
          echo "  \"word_count\": \"${{ inputs.word_count }}\"," >> "output/${ARTICLE_ID}/input_params.json"
          echo "  \"created_at\": \"${TIMESTAMP}\"" >> "output/${ARTICLE_ID}/input_params.json"
          echo '}' >> "output/${ARTICLE_ID}/input_params.json"

      - name: Upload initialization artifacts
        uses: actions/upload-artifact@v4
        with:
          name: init-${{ steps.init.outputs.article_id }}
          path: output/${{ steps.init.outputs.article_id }}
          retention-days: 30

  # ã‚¸ãƒ§ãƒ–2: ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ†æ
  analysis:
    needs: initialize
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 10
    outputs:
      main_keyword: ${{ steps.analyze.outputs.main_keyword }}
      
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download initialization artifacts
        uses: actions/download-artifact@v4
        with:
          name: init-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: ${{ env.PYTHON_VERSION }}

      - name: Install dependencies
        run: |
          cd github-actions
          pip install -r requirements.txt

      - name: Create analysis input
        run: |
          cd output/${{ needs.initialize.outputs.article_id }}
          # Phase1ãŒæœŸå¾…ã™ã‚‹å½¢å¼ã®JSONã‚’ä½œæˆ
          echo '{' > request_params.json
          echo "  \"topic\": \"${{ inputs.article_title }}\"," >> request_params.json
          echo "  \"target_audience\": \"${{ inputs.approach_target }}\"," >> request_params.json
          echo "  \"keywords\": \"${{ inputs.main_keywords }}\"" >> request_params.json
          echo '}' >> request_params.json

      - name: Run Phase 1 Analysis with Claude
        uses: anthropics/claude-code-base-action@beta
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          
          prompt: |
            # ç›®çš„: è¨˜äº‹ç”Ÿæˆã®ãŸã‚ã®åˆ†æçµæœã‚’phase1_output.jsonãƒ•ã‚¡ã‚¤ãƒ«ã«å¿…ãšä½œæˆã™ã‚‹ï¼ˆARTICLE-TEMPLATE-README.mdæº–æ‹ ï¼‰
            
            ã“ã®ã‚¿ã‚¹ã‚¯ã¯phase1_output.jsonãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã§å®Œäº†ã¨ã—ã¾ã™ã€‚åˆ†æã ã‘ã—ã¦çµ‚ã‚ã‚‹ã®ã¯ç¦æ­¢ã§ã™ã€‚
            **æ³¨æ„ï¼šæœ€çµ‚çš„ã«ARTICLE-TEMPLATE-README.mdã®CSSã‚¯ãƒ©ã‚¹ä»•æ§˜ã«å®Œå…¨æº–æ‹ ã—ãŸHTMLã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã‚’å‰æã«åˆ†æã—ã¦ãã ã•ã„ã€‚**
            
            ## ç´å“ç‰©ï¼ˆå¿…é ˆï¼‰
            - **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: output/${{ needs.initialize.outputs.article_id }}/phase1_output.json
            - **å½¢å¼**: UTF-8ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®å³å¯†ãªJSONï¼ˆã‚³ãƒ¡ãƒ³ãƒˆãƒ»æœ«å°¾ã‚«ãƒ³ãƒç„¡ã—ï¼‰
            - **çµ¶å¯¾æ¡ä»¶**: ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ã¨å¾Œç¶šã‚¸ãƒ§ãƒ–ãŒå…¨ã¦å¤±æ•—ã—ã¾ã™
            
            ## æ‰‹é †ï¼ˆã“ã®é †åºã§å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼‰
            1. ã¾ãš output/${{ needs.initialize.outputs.article_id }}/phase1_output.json ã‚’ç©ºã®JSONã§ä½œæˆ
            2. output/${{ needs.initialize.outputs.article_id }}/request_params.json ã‚’èª­ã¿è¾¼ã‚€
            3. ä»¥ä¸‹ã®åˆ†æã‚’å®Ÿè¡Œ
            4. åˆ†æçµæœã§phase1_output.jsonã‚’ä¸Šæ›¸ãä¿å­˜
            5. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿ç›´ã—ã¦JSONãŒæ­£ã—ã„ã“ã¨ã‚’æ¤œè¨¼
            6. ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¨æœ€åˆã®100æ–‡å­—ã‚’å‡ºåŠ›ã—ã¦ä½œæˆã‚’ç¢ºèª
            
            ## åˆ†æã‚¿ã‚¹ã‚¯
            ### å…¥åŠ›æƒ…å ±
            - è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«: ${{ inputs.article_title }}
            - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ«ã‚½ãƒŠ: ${{ inputs.approach_target }}
            - ãƒ¡ã‚¿ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ${{ inputs.main_keywords }}
            - ç›®æ¨™æ–‡å­—æ•°: ${{ inputs.word_count }}
            
            ### åˆ†æå†…å®¹
            1. ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ç‰¹å®šï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã‹ã‚‰æœ€é‡è¦èªã‚’1ã¤ï¼‰
            2. é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®æŠ½å‡ºï¼ˆ5-8å€‹ï¼‰
            3. æ¤œç´¢æ„å›³ã®åˆ†æï¼ˆinformational/navigational/transactional/commercialï¼‰
            4. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ã®æ±ºå®šï¼ˆhow-to/guide/comparison/review/tipsï¼‰
            5. ãƒˆãƒ¼ãƒ³ã®è¨­å®šï¼ˆfriendly/professional/casual/authoritativeï¼‰
            6. ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆã®æŠ½å‡ºï¼ˆãƒšãƒ«ã‚½ãƒŠãŒçŸ¥ã‚ŠãŸã„3-5å€‹ï¼‰
            7. ãƒªã‚µãƒ¼ãƒã‚¯ã‚¨ãƒªã®ç”Ÿæˆï¼ˆå¿…ãš15å€‹ä»¥ä¸Šã€ç†æƒ³ã¯20å€‹ï¼‰
            
            ## å¿…é ˆJSONã‚¹ã‚­ãƒ¼ãƒ
            {
              "analysis": {
                "main_keyword": "stringï¼ˆå¿…é ˆï¼‰",
                "related_keywords": ["arrayï¼ˆ5å€‹ä»¥ä¸Šå¿…é ˆï¼‰"],
                "search_intent": "informationalï¼ˆå¿…é ˆï¼‰",
                "content_type": "how-toï¼ˆå¿…é ˆï¼‰",
                "tone": "friendlyï¼ˆå¿…é ˆï¼‰",
                "key_points": ["arrayï¼ˆ3å€‹ä»¥ä¸Šå¿…é ˆï¼‰"],
                "research_queries": ["arrayï¼ˆ15å€‹ä»¥ä¸Šå¿…é ˆï¼‰"],
                "competitor_analysis_needed": true,
                "local_seo_focus": false,
                "estimated_sections": 5
              },
              "topic": "${{ inputs.article_title }}",
              "target_audience": "${{ inputs.approach_target }}",
              "keywords": "${{ inputs.main_keywords }}",
              "processed_at": "ISO8601å½¢å¼ã®ç¾åœ¨æ™‚åˆ»",
              "workflow_version": "4.0.0"
            }
            
            ## åˆ¶ç´„äº‹é …
            - ãƒãƒ£ãƒƒãƒˆã«JSONã‚’å‡ºåŠ›ã—ãªã„ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã«ç›´æ¥æ›¸ãè¾¼ã‚€ï¼‰
            - åˆ†æãŒä¸å®Œå…¨ã§ã‚‚å¿…ãšãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆæœ€ä½é™ã®æ§‹é€ ã§ï¼‰
            - research_queriesã¯æœ€ä½15å€‹å¿…é ˆï¼ˆå¾Œç¶šå‡¦ç†ã®ãŸã‚ï¼‰
            - ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä½œæˆãƒ»å¤‰æ›´ã—ãªã„
            - å¥åº·ãƒ»ç¾å®¹åˆ†é‡ã§ã¯è–¬æ©Ÿæ³•ãƒ»æ™¯è¡¨æ³•ã¸ã®é…æ…®
            
            ## å¤±æ•—æ™‚ã®å‡¦ç†
            ä½•ã‚‰ã‹ã®ç†ç”±ã§åˆ†æãŒå¤±æ•—ã—ãŸå ´åˆã§ã‚‚ã€ä»¥ä¸‹ã®æœ€å°æ§‹é€ ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š
            - main_keyword: ã‚¿ã‚¤ãƒˆãƒ«ã®æœ€åˆã®å˜èª
            - research_queries: ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…ƒã«æ©Ÿæ¢°çš„ã«15å€‹ç”Ÿæˆ
            - ãã®ä»–: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®š
            
            ## å®Œäº†æ¡ä»¶ï¼ˆå¿…é ˆç¢ºèªé …ç›®ï¼‰
            1. output/${{ needs.initialize.outputs.article_id }}/phase1_output.json ãŒå­˜åœ¨ã™ã‚‹
            2. JSONã¨ã—ã¦æœ‰åŠ¹ã§ã‚ã‚‹ï¼ˆãƒ‘ãƒ¼ã‚¹å¯èƒ½ï¼‰
            3. analysis.research_queries ãŒ15å€‹ä»¥ä¸Šå«ã¾ã‚Œã‚‹
            4. ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒ1KBä»¥ä¸Šã‚ã‚‹
          
          allowed_tools: |
            Read,
            Write
          
          claude_env: |
            ARTICLE_ID=${{ needs.initialize.outputs.article_id }}
          
          max_turns: "5"
      
      - name: Verify and prepare analysis results
        run: |
          echo "ğŸ” Checking for analysis files..."
          echo "Current working directory: $(pwd)"
          echo "Files in root:"
          ls -la
          echo "Files in output directory:"
          ls -la output/${{ needs.initialize.outputs.article_id }}/
          
          cd output/${{ needs.initialize.outputs.article_id }}
          if [ -f "phase1_output.json" ]; then
            echo "âœ… Phase 1 analysis file found"
            cat phase1_output.json
          else
            echo "âš ï¸ Phase 1 analysis file not found, creating default"
            # Check if file was created in root directory by mistake
            if [ -f "../../phase1_output.json" ]; then
              echo "ğŸ“ Found phase1_output.json in root, moving to correct location"
              mv ../../phase1_output.json ./phase1_output.json
            else
              echo "ğŸ”§ Creating fallback analysis file"
              # Create fallback analysis if Claude didn't create the file
              TIMESTAMP=$(date -u +%Y-%m-%dT%H:%M:%SZ)
              TITLE="${{ inputs.article_title }}"
              PERSONA="${{ inputs.approach_target }}"
              KEYWORDS="${{ inputs.main_keywords }}"
              EEAT_ELEMENTS="${{ inputs.eeat_elements }}"
              
              # å¤–éƒ¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦JSONã‚’ä½œæˆ
              TITLE="${TITLE}" PERSONA="${PERSONA}" KEYWORDS="${KEYWORDS}" EEAT_ELEMENTS="${EEAT_ELEMENTS}" TIMESTAMP="${TIMESTAMP}" OUTPUT_DIR="." python3 ../../github-actions/scripts/create_phase1_fallback.py
            fi
          fi
          
          echo "ğŸ“‹ Final verification - files in current directory:"
          ls -la

      - name: Split research queries into batches
        id: analyze
        run: |
          # ã‚¯ã‚¨ãƒªã‚’5ãƒãƒƒãƒã«åˆ†å‰²
          cd output/${{ needs.initialize.outputs.article_id }}
          python3 ../../github-actions/scripts/split_research_queries.py
          
          # ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å‡ºåŠ›
          if [ -f "research_meta.json" ]; then
            MAIN_KW=$(python -c "import json; print(json.load(open('research_meta.json'))['main_keyword'])")
            echo "main_keyword=${MAIN_KW}" >> $GITHUB_OUTPUT
          fi
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
          ENABLE_GEMINI_RESEARCH: "true"

      - name: Upload analysis artifacts
        uses: actions/upload-artifact@v4
        with:
          name: analysis-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}
          retention-days: 30

  # ã‚¸ãƒ§ãƒ–3: ãƒªã‚µãƒ¼ãƒï¼ˆGeminiä½¿ç”¨ - ä¸¦åˆ—å®Ÿè¡Œï¼‰
  research:
    needs: [initialize, analysis]
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 15
    strategy:
      matrix:
        batch: [0, 1, 2]  # Reduced to 3 batches to match max-parallel
      max-parallel: 3  # Balanced for rate limiting with gemini-2.5-flash
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download initialization artifacts
        uses: actions/download-artifact@v4
        with:
          name: init-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}

      - name: Download analysis artifacts
        uses: actions/download-artifact@v4
        with:
          name: analysis-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: ${{ env.PYTHON_VERSION }}

      - name: Install dependencies
        run: |
          cd github-actions
          pip install -r requirements.txt
          
      - name: Install Gemini API dependencies  
        run: |
          pip install google-genai

      - name: Research with Gemini (Batch ${{ matrix.batch }})
        run: |
          cd output/${{ needs.initialize.outputs.article_id }}
          
          # ãƒãƒƒãƒç”¨ã®åˆ†æãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
          BATCH_NUM=${{ matrix.batch }} python3 ../../github-actions/scripts/create_batch_analysis.py
          
          # ãƒãƒƒãƒã‚¯ã‚¨ãƒªã‚’èª­ã¿è¾¼ã‚“ã§Gemini APIã§ç›´æ¥æ¤œç´¢ï¼ˆå¤–éƒ¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½¿ç”¨ï¼‰
          python3 ../../github-actions/scripts/research_batch_gemini.py ${{ matrix.batch }}
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}

      - name: Upload research batch artifacts
        uses: actions/upload-artifact@v4
        with:
          name: research-batch-${{ matrix.batch }}-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}/batch_${{ matrix.batch }}
          retention-days: 30

  # ã‚¸ãƒ§ãƒ–4: ãƒªã‚µãƒ¼ãƒçµæœã®çµ±åˆ
  research-merge:
    needs: [initialize, research]
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 10
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Create output directory
        run: mkdir -p output/${{ needs.initialize.outputs.article_id }}

      - name: Download all research batches
        uses: actions/download-artifact@v4
        with:
          pattern: research-batch-*-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}/batches

      - name: Download analysis artifacts
        uses: actions/download-artifact@v4
        with:
          name: analysis-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}

      - name: Merge research results
        run: |
          cd output/${{ needs.initialize.outputs.article_id }}
          
          # ãƒªã‚µãƒ¼ãƒçµæœã‚’çµ±åˆã—ã¦V4å‡ºåŠ›å½¢å¼ã«ã™ã‚‹
          python3 ../../github-actions/scripts/merge_research_results.py
          
          # V4ç”¨ã«ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å¤‰æ›´
          if [ -f "phase2_research.json" ]; then
            mv phase2_research.json research_results.json
            echo "âœ… Created research_results.json for V4"
          fi

      - name: Upload merged research artifacts
        uses: actions/upload-artifact@v4
        with:
          name: research-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}
          retention-days: 30

  # ã‚¸ãƒ§ãƒ–5: è¨˜äº‹æ§‹æˆã®ç”Ÿæˆï¼ˆSEOå‰Šé™¤ç‰ˆï¼‰
  generate-structure:
    needs: [initialize, analysis, research-merge]
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 15
      
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download artifacts
        uses: actions/download-artifact@v4
        with:
          pattern: '*-${{ needs.initialize.outputs.article_id }}'
          path: output/${{ needs.initialize.outputs.article_id }}
          merge-multiple: true

      - name: Generate article structure with Claude
        uses: anthropics/claude-code-base-action@beta
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          
          prompt: |
            # è¨˜äº‹æ§‹æˆç”Ÿæˆ
            
            å¥åº·ãƒ»ç¾å®¹ã«é–¢ã™ã‚‹è¨˜äº‹ã®åŸºæœ¬æ§‹æˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ï¼ˆSEOæœ€é©åŒ–ã¯å¾Œã®å·¥ç¨‹ã§å®Ÿæ–½ã™ã‚‹ãŸã‚ã€èª­è€…ã«ä¾¡å€¤ã®ã‚ã‚‹æ§‹æˆã«é‡ç‚¹ã‚’ç½®ãï¼‰
            
            ## å…¥åŠ›æƒ…å ±
            
            ### åŸºæœ¬æƒ…å ±
            - **è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«**: ${{ inputs.article_title }}
            - **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ«ã‚½ãƒŠ**: ${{ inputs.approach_target }}
            - **ãƒ¡ã‚¿ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰**: ${{ inputs.main_keywords }}
            - **ç›®æ¨™æ–‡å­—æ•°**: ${{ inputs.word_count }}
            
            ## ã‚¿ã‚¹ã‚¯
            
            ã¾ãšã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ç†è§£ã—ã¦ãã ã•ã„ï¼š
            - output/${{ needs.initialize.outputs.article_id }}/input_params.json: å…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
            - output/${{ needs.initialize.outputs.article_id }}/phase1_output.json: åˆ†æçµæœ
            - output/${{ needs.initialize.outputs.article_id }}/research_results.json: ãƒªã‚µãƒ¼ãƒçµæœ
            
            åˆ†æã¨ãƒªã‚µãƒ¼ãƒçµæœã‚’è¸ã¾ãˆã¦ã€ãƒšãƒ«ã‚½ãƒŠã«æœ€é©åŒ–ã•ã‚ŒãŸè¨˜äº‹æ§‹æˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
            
            ### 1. è¨˜äº‹æ§‹æˆï¼ˆ01_article_structure.mdï¼‰ã‚’ä½œæˆ
            
            output/${{ needs.initialize.outputs.article_id }}/01_article_structure.md ã¨ã—ã¦ä»¥ä¸‹ã®è¦ç´ ã‚’å«ã‚€è©³ç´°ãªæ§‹æˆã‚’ä½œæˆï¼š
            
            - å°å…¥éƒ¨ï¼ˆãƒªãƒ¼ãƒ‰æ–‡ï¼‰ï¼šãƒšãƒ«ã‚½ãƒŠã®æ‚©ã¿ã«å…±æ„Ÿã—ã€è¨˜äº‹ã®ä¾¡å€¤ã‚’æ˜ç¢ºã«ã™ã‚‹ï¼ˆ300-500æ–‡å­—ï¼‰
            - ç›®æ¬¡ï¼šH2ãƒ¬ãƒ™ãƒ«ã®è¦‹å‡ºã—5-7å€‹
            - ãƒ¡ã‚¤ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼šå„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®çš„ã€å«ã‚ã‚‹å†…å®¹ã€æ–‡å­—æ•°ç›®å®‰ï¼ˆ400-600æ–‡å­—ï¼‰
            - FAQéƒ¨åˆ†ï¼šãƒšãƒ«ã‚½ãƒŠãŒã‚ˆãæŒã¤ç–‘å•3-5å€‹
            - ã¾ã¨ã‚ï¼šè¨˜äº‹ã®è¦ç‚¹ã¨æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
            
            ### 2. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¨ˆç”»ï¼ˆ02_content_plan.mdï¼‰ã‚’ä½œæˆ
            
            output/${{ needs.initialize.outputs.article_id }}/02_content_plan.md ã¨ã—ã¦å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è©³ç´°ãªå†…å®¹è¨ˆç”»ã‚’ä½œæˆï¼š
            
            - ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥è©³ç´°è¨ˆç”»ï¼šã‚­ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ä½¿ç”¨ã™ã‚‹ãƒªã‚µãƒ¼ãƒæƒ…å ±ã€å«ã‚ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
            - ãƒšãƒ«ã‚½ãƒŠæœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆï¼šãƒšãƒ«ã‚½ãƒŠã®ç‰¹æ€§ã«åˆã‚ã›ãŸè¡¨ç¾æ–¹æ³•
            - è–¬æ©Ÿæ³•ãƒ»æ™¯è¡¨æ³•é…æ…®äº‹é …ï¼šæ³¨æ„ã™ã¹ãè¡¨ç¾ã€ä»£æ›¿è¡¨ç¾ã®ææ¡ˆ
            
            ## å‡ºåŠ›è¦ä»¶
            
            - <strong>èª­è€…ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ</strong>: SEOã‚ˆã‚Šã‚‚ãƒšãƒ«ã‚½ãƒŠã®ä¾¡å€¤ã‚’é‡è¦–
            - <strong>è«–ç†çš„ãªæµã‚Œ</strong>: èª­è€…ã®ç–‘å•ãŒè‡ªç„¶ã«è§£æ±ºã•ã‚Œã‚‹æ§‹æˆ
            - <strong>å®Ÿç”¨æ€§</strong>: å…·ä½“çš„ã§å®Ÿè·µã—ã‚„ã™ã„å†…å®¹
            - <strong>ä¿¡é ¼æ€§</strong>: ãƒªã‚µãƒ¼ãƒçµæœã«åŸºã¥ã„ãŸæ­£ç¢ºãªæƒ…å ±
            - <strong>æ³•è¦åˆ¶å¯¾å¿œ</strong>: è–¬æ©Ÿæ³•ãƒ»æ™¯è¡¨æ³•ã«é…æ…®ã—ãŸè¡¨ç¾è¨ˆç”»
          
          allowed_tools: |
            Read,
            Write,
            Edit
          
          claude_env: |
            ARTICLE_ID=${{ needs.initialize.outputs.article_id }}
          
          max_turns: "10"

      - name: Upload structure artifacts
        uses: actions/upload-artifact@v4
        with:
          name: structure-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}
          retention-days: 30

  # ã‚¸ãƒ§ãƒ–6: è¨˜äº‹æœ¬æ–‡ã®ç”Ÿæˆï¼ˆMDå°‚ç”¨ï¼‰
  generate-content:
    needs: [initialize, generate-structure]
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 20
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download artifacts
        uses: actions/download-artifact@v4
        with:
          pattern: '*-${{ needs.initialize.outputs.article_id }}'
          path: output/${{ needs.initialize.outputs.article_id }}
          merge-multiple: true

      - name: Generate article content with Claude
        uses: anthropics/claude-code-base-action@beta
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          prompt: |
            # è¨˜äº‹æœ¬æ–‡ç”Ÿæˆï¼ˆHTMLå½¢å¼ï¼‰
            
            ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ©ã‚¤ã‚¿ãƒ¼ã¨ã—ã¦ã€Phase 2ã®æ§‹æˆã«å¾“ã£ã¦é«˜å“è³ªãªè¨˜äº‹ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
            **ARTICLE-TEMPLATE-README.mdã®CSSã‚¯ãƒ©ã‚¹ä»•æ§˜ã‚’å®Œå…¨ã«éµå®ˆã—ã¦ãã ã•ã„ã€‚**
            
            ## å…¥åŠ›æƒ…å ±
            
            ### åŸºæœ¬æƒ…å ±
            - <strong>è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«</strong>: ${{ inputs.article_title }}
            - <strong>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ«ã‚½ãƒŠ</strong>: ${{ inputs.approach_target }}
            - <strong>ç›®æ¨™æ–‡å­—æ•°</strong>: ${{ inputs.word_count }}
            
            ## ã‚¿ã‚¹ã‚¯
            
            ã¾ãšã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§å†…å®¹ã‚’ç†è§£ã—ã¦ãã ã•ã„ï¼š
            - output/${{ needs.initialize.outputs.article_id }}/phase1_output.json: Phase 1ã®åˆ†æçµæœ
            - output/${{ needs.initialize.outputs.article_id }}/01_article_structure.md: Phase 2ã®è¨˜äº‹æ§‹æˆ
            - output/${{ needs.initialize.outputs.article_id }}/02_content_plan.md: Phase 2ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¨ˆç”»
            - output/${{ needs.initialize.outputs.article_id }}/research_results.json: ãƒªã‚µãƒ¼ãƒçµæœï¼ˆå‡ºå…¸URLå«ã‚€ï¼‰
            
            ## è¨˜äº‹ç”Ÿæˆãƒ«ãƒ¼ãƒ«ï¼ˆARTICLE-TEMPLATE-README.mdå®Œå…¨æº–æ‹ ï¼‰
            
            ### 1. åŸºæœ¬æ–¹é‡
            - **Phase 2ã®æ§‹æˆã‚’å¿ å®Ÿã«å®Ÿè£…**ã—ã¦ãã ã•ã„
            - WordPressã®HTMLãƒ–ãƒ­ãƒƒã‚¯ã«è²¼ã‚Šä»˜ã‘ã‚‹ã“ã¨ã‚’å‰æ
            - ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ã§èª­ã¿ã‚„ã™ã„HTMLã‚’ç”Ÿæˆ
            - **é‡è¦ï¼šã“ã‚Œã¯CSSã‚¯ãƒ©ã‚¹åã®ä»•æ§˜æ›¸ã§ã™ã€‚è¨˜äº‹æ§‹æˆã§ã¯ãªãHTMLãƒ‘ãƒ¼ãƒ„é›†ã§ã™**
            - **è¶…é‡è¦ï¼šMarkdownè¨˜æ³•ã¯ä¸€åˆ‡ä½¿ç”¨ã›ãšã€ã™ã¹ã¦ç´”ç²‹ãªHTMLã‚¿ã‚°ã§è¨˜è¿°ã™ã‚‹ã“ã¨**
            
            ### 1.1 HTMLè¨˜æ³•ã®å³å®ˆï¼ˆçµ¶å¯¾éµå®ˆï¼‰
            
            **çµ¶å¯¾ã«ä½¿ç”¨ç¦æ­¢ï¼ˆMarkdownè¨˜æ³•ï¼‰â†’ å¿…ãšä½¿ç”¨ã™ã¹ãHTMLã‚¿ã‚°ï¼š**
            - `###` è¦‹å‡ºã— â†’ `<h3>è¦‹å‡ºã—</h3>` ã‚’ä½¿ç”¨
            - `##` è¦‹å‡ºã— â†’ `<h2>è¦‹å‡ºã—</h2>` ã‚’ä½¿ç”¨  
            - `**å¤ªå­—**` â†’ `<strong>å¤ªå­—</strong>` ã‚’ä½¿ç”¨
            - `*æ–œä½“*` â†’ `<em>æ–œä½“</em>` ã‚’ä½¿ç”¨
            - `1. ãƒªã‚¹ãƒˆé …ç›®` â†’ `<ol><li>ãƒªã‚¹ãƒˆé …ç›®</li></ol>` ã‚’ä½¿ç”¨
            - `- ãƒªã‚¹ãƒˆé …ç›®` â†’ `<ul><li>ãƒªã‚¹ãƒˆé …ç›®</li></ul>` ã‚’ä½¿ç”¨
            - `` `ã‚³ãƒ¼ãƒ‰` `` â†’ `<code>ã‚³ãƒ¼ãƒ‰</code>` ã‚’ä½¿ç”¨
            
            **ã™ã¹ã¦ã®æ–‡ç« ã€è¦‹å‡ºã—ã€ãƒªã‚¹ãƒˆã¯å¿…ãšHTMLã‚¿ã‚°ã§è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚**
            Markdownè¨˜æ³•ãŒ1ç®‡æ‰€ã§ã‚‚å«ã¾ã‚Œã¦ã„ãŸå ´åˆã¯ç”Ÿæˆå¤±æ•—ã¨ã¿ãªã—ã¾ã™ã€‚
            è¨˜äº‹å†…ã®H2ã€H3è¦‹å‡ºã—ã¯ã™ã¹ã¦`<h2>` `<h3>`ã‚¿ã‚°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚
            
            ### 2. HTMLæ§‹é€ ã®è¦ä»¶
            
            åŸºæœ¬æ§‹é€ ï¼ˆå¿…é ˆï¼‰ï¼š
            ```html
            <div class="article-content">
              <!-- è¨˜äº‹å…¨ä½“ã‚’ã“ã®ã‚³ãƒ³ãƒ†ãƒŠã§å›²ã‚€ï¼ˆ1è¨˜äº‹ã«1ã¤ã®ã¿ï¼‰ -->
              <!-- ä»¥ä¸‹ã€Phase 2ã®æ§‹æˆã«å¾“ã£ã¦è¨˜äº‹ã‚’å±•é–‹ -->
            </div>
            ```
            
            æ¨™æº–ãƒ‘ãƒ¼ãƒ„ï¼š
            
            <strong>å°å…¥éƒ¨åˆ†ï¼š</strong>
            - ä¿¡é ¼æ€§ãƒãƒƒã‚¸: `<div class="article-expert-badge">`
            - ãƒªãƒ¼ãƒ‰ãƒ†ã‚­ã‚¹ãƒˆ: `<p class="article-lead-text">`
            - ç›®æ¬¡: `<div class="article-toc">` ï¼ˆã‚¢ãƒ³ã‚«ãƒ¼ãƒªãƒ³ã‚¯ã‚’æ­£ã—ãè¨­å®šï¼‰
            
            <strong>æœ¬æ–‡ãƒ‘ãƒ¼ãƒ„ï¼š</strong>
            - ãƒã‚¤ãƒ©ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ï¼ˆ**é‡è¦ï¼š1ã‚»ã‚¯ã‚·ãƒ§ãƒ³1å€‹ã¾ã§å³å®ˆ**ï¼‰: `<div class="article-highlight-box">`
            - ã‚¹ãƒ†ãƒƒãƒ—ãƒªã‚¹ãƒˆ: `<ol class="article-steps-list">`
            - æ¯”è¼ƒãƒ†ãƒ¼ãƒ–ãƒ«: `<table class="article-comparison-table">`
            - å¼•ç”¨ãƒ–ãƒ­ãƒƒã‚¯: `<div class="article-quote">`
            - å¼•ç”¨å…ƒæ³¨è¨˜: `<span class="quote-source">`
            
            <strong>ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰ï¼ˆãŠå®¢æ§˜ã®å£°ï¼‰ï¼š</strong>
            - ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰å…¨ä½“: `<div class="review-cards-section">`
            - å€‹åˆ¥ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰: `<div class="review-card">`
            - ã‚¢ãƒã‚¿ãƒ¼ç”»åƒ: `<div class="review-avatar">`
            - ãƒ¬ãƒ“ãƒ¥ãƒ¼å†…å®¹éƒ¨åˆ†: `<div class="review-content">`
            - æŠ•ç¨¿è€…æƒ…å ±: `<h3 class="review-author">`
            - ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆ: `<p class="review-text">`
            
            <strong>ç”»åƒãƒ»ãƒ¡ãƒ‡ã‚£ã‚¢ï¼š</strong>
            - ç”»åƒã‚³ãƒ³ãƒ†ãƒŠ: `<div class="article-content-image">`
            - ç”»åƒæœ¬ä½“: `<img>` ï¼ˆarticle-content-imageå†…ï¼‰
            - ç”»åƒã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³: `<figcaption>`
            
            <strong>ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¦ç´ ï¼š</strong>
            - ã¾ã¨ã‚ã‚»ã‚¯ã‚·ãƒ§ãƒ³: `<section class="article-summary-section">`
            - CTAã‚»ã‚¯ã‚·ãƒ§ãƒ³: `<section class="article-cta-section">`
            - CTAãƒœã‚¿ãƒ³: `<a class="article-cta-button">`
            - é–¢é€£è¨˜äº‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³: `<section class="article-related-section">`
            - å‚è€ƒè³‡æ–™ã‚»ã‚¯ã‚·ãƒ§ãƒ³: `<section class="article-reference-section">`
            - ä¿¡é ¼æ€§æƒ…å ±: `<div class="article-reliability-info">`
            
            ### 3. FAQéƒ¨åˆ†ï¼ˆé‡è¦ï¼šæ§‹é€ ã‚’æ­£ç¢ºã«ãƒ»IDé‡è¤‡ã‚¨ãƒ©ãƒ¼é˜²æ­¢ï¼‰
            
            ```html
            <div class="article-faq-section">
              <h2>ã‚ˆãã‚ã‚‹è³ªå•</h2>
              
              <div class="article-faq-item">
                <input type="checkbox" id="faq1">  <!-- å¿…ãšä¸€æ„ã®ID -->
                <label for="faq1" class="article-faq-question">  <!-- IDã¨å®Œå…¨ä¸€è‡´ -->
                  <span>Q1: è³ªå•å†…å®¹</span>  <!-- å¿…ãšspanè¦ç´ ã§å›²ã‚€ -->
                </label>
                <div class="article-faq-answer">A1: å›ç­”å†…å®¹</div>
              </div>
              <!-- faq2, faq3... ã¨é€£ç•ªã§ç¶šã‘ã‚‹ -->
            </div>
            ```
            
            **FAQã‚¨ãƒ©ãƒ¼é˜²æ­¢ãƒã‚§ãƒƒã‚¯ï¼š**
            - å„FAQé …ç›®ã§**ãƒšãƒ¼ã‚¸å†…ã§ä¸€æ„ã®ID**ã‚’è¨­å®šï¼ˆfaq1, faq2, faq3...ï¼‰
            - inputã®idã¨labelã®forã‚’å®Œå…¨ä¸€è‡´ã•ã›ã‚‹
            - åŒã˜idã‚’è¤‡æ•°å›ä½¿ç”¨ã—ãªã„ï¼ˆ**1ãƒšãƒ¼ã‚¸å†…ã§ã®IDé‡è¤‡ã¯çµ¶å¯¾ç¦æ­¢**ï¼‰
            - è³ªå•æ–‡ã¯å¿…ãš`<span>`è¦ç´ ã§å›²ã‚€
            - ä»–ã®è¦ç´ ï¼ˆè¦‹å‡ºã—ç­‰ï¼‰ã®IDã¨ã‚‚é‡è¤‡ã—ãªã„ã‚ˆã†æ³¨æ„
            
            ### 4. å‡ºå…¸ãƒ»å¼•ç”¨ã®æ‰±ã„æ–¹
            
            æœ¬æ–‡ä¸­ã§çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚„å°‚é–€çš„ä¸»å¼µã‚’è¿°ã¹ã‚‹éš›ã¯å¿…ãšå‡ºå…¸ã‚’ä»˜ã‘ã¦ãã ã•ã„ï¼š
            
            ```html
            <!-- æœ¬æ–‡ä¸­ã®è„šæ³¨ãƒªãƒ³ã‚¯ -->
            <p>ç ”ç©¶çµæœã«ã‚ˆã‚‹ã¨<a class="article-cite" href="#fn-1" id="fnref-1">[1]</a>ã€ã€‡ã€‡ã¨ã„ã†ã“ã¨ãŒæ˜ã‚‰ã‹ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
            
            <!-- å¼•ç”¨ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆã‚ˆãã‚ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ï¼‰ -->
            <div class="article-quote">
              <p>å¼•ç”¨ã—ãŸã„å†…å®¹ã‚’ã“ã“ã«è¨˜è¼‰ã—ã¾ã™<a class="article-cite" href="#fn-2">[2]</a>ã€‚</p>
              <span class="quote-source">å‚è€ƒ: é–¢é€£æ©Ÿé–¢ã®è¦‹è§£</span>
            </div>
            
            <!-- è¨˜äº‹æœ«å°¾ã®å‡ºå…¸ãƒªã‚¹ãƒˆ -->
            <div class="article-reliability-info">
              <h3>ã“ã®è¨˜äº‹ã®ä¿¡é ¼æ€§ã«ã¤ã„ã¦</h3>
              <ol class="article-citations">
                <li id="fn-1">
                  <a href="å®Ÿéš›ã®URL" target="_blank" rel="noopener">å‡ºå…¸å</a>
                  <a href="#fnref-1" class="fn-back">â†©</a>
                </li>
              </ol>
            </div>
            ```
            
            **å¼•ç”¨é–¢é€£ã‚¯ãƒ©ã‚¹ã®ä½¿ã„æ–¹ï¼š**
            - `article-cite`: æœ¬æ–‡ä¸­ã®è„šæ³¨ãƒªãƒ³ã‚¯ï¼ˆä¾‹: [1]ï¼‰
            - `article-citations`: æœ«å°¾ã®å‡ºå…¸ãƒªã‚¹ãƒˆï¼ˆç•ªå·ä»˜ãï¼‰
            - `fn-back`: å‡ºå…¸ã‹ã‚‰æœ¬æ–‡ã¸æˆ»ã‚‹ãƒªãƒ³ã‚¯ï¼ˆâ†©ï¼‰
            - `article-quote`: å¼•ç”¨ç”¨ã®å¼·èª¿ãƒ–ãƒ­ãƒƒã‚¯
            - `quote-source`: å¼•ç”¨å…ƒã®çŸ­ã„æ³¨è¨˜
            
            ãƒªã‚µãƒ¼ãƒçµæœã‹ã‚‰5ã¤ä»¥ä¸Šã®å‡ºå…¸ã‚’å¼•ç”¨ã—ã¦ãã ã•ã„ã€‚
            
            ### 5. strongã‚¿ã‚°ã®ä½¿ç”¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆé‡è¦ï¼šé©åˆ‡ãªä½¿ç”¨ç®‡æ‰€ã®å³å®ˆï¼‰
            
            <strong>ä½¿ç”¨ã™ã‚‹å ´æ‰€ï¼ˆæ–‡ç« å†…ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆã®ã¿ï¼‰ï¼š</strong>
            - æ–‡ç« å†…ã®é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ
            - æ³¨æ„ç‚¹ã€æ¨å¥¨äº‹é …
            - æˆåŠŸã®ã‚³ãƒ„
            - èª­è€…ã®ç†è§£ã‚’åŠ©ã‘ã‚‹å¼·èª¿
            
            <strong>çµ¶å¯¾ã«ä½¿ç”¨ã—ãªã„å ´æ‰€ï¼š</strong>
            - ãƒ©ãƒ™ãƒ«ï¼ˆã€Œä½æ‰€ï¼šã€ã€Œé›»è©±ç•ªå·ï¼šã€ãªã©ï¼‰
            - é …ç›®åãƒ»è¦‹å‡ºã—
            - çŸ­ã„å˜èªã‚„ãƒ©ãƒ™ãƒ«
            - å°‚é–€å®¶ãƒãƒƒã‚¸å†…
            - CTAã‚»ã‚¯ã‚·ãƒ§ãƒ³å†…ã®å®šå‹æ–‡
            
            ### 6. ãƒã‚¤ãƒ©ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½¿ç”¨åˆ¶é™ï¼ˆé‡è¦ï¼šä½¿ç”¨æ•°ã®å³å®ˆï¼‰
            
            - <strong>å°å…¥éƒ¨åˆ†ï¼ˆãƒªãƒ¼ãƒ‰ãƒ†ã‚­ã‚¹ãƒˆå‘¨è¾ºï¼‰</strong>: ã‚­ãƒ£ãƒƒãƒãƒ¼ã•ã‚’æ¼”å‡ºã™ã‚‹ãŸã‚ç©æ¥µçš„ã«ä½¿ç”¨æ¨å¥¨
            - <strong>ãƒ¡ã‚¤ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³å†…</strong>: **h2è¦‹å‡ºã—å˜ä½ã§1å€‹ã¾ã§å³å®ˆ**ã€æœ¬å½“ã«é‡è¦ãªæƒ…å ±ã®ã¿
            - <strong>éåº¦ãªä½¿ç”¨ã¯çµ¶å¯¾ã«é¿ã‘ã‚‹</strong>: åŸºæœ¬ã¯h3+pæ§‹é€ ã‚’ä½¿ç”¨
            - <strong>æ–™é‡‘ãƒ»é‡è¦æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³</strong>: è¤‡é›‘ãªæƒ…å ±ã‚’æ•´ç†ã™ã‚‹å ´åˆã¯ä½¿ç”¨å¯
            - **åŸºæœ¬æ§‹æˆï¼šh3è¦‹å‡ºã— + pãƒ†ã‚­ã‚¹ãƒˆã‚’åŸºæœ¬ã¨ã—ã€ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹é€ ã‚’å¿ƒãŒã‘ã‚‹**
            - **ã‚»ã‚¯ã‚·ãƒ§ãƒ³å®šç¾©ï¼šh2ã‚¿ã‚°ã§åŒºåˆ‡ã‚‰ã‚ŒãŸç¯„å›²ã‚’1ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã™ã‚‹**
            
            ### 7. ãƒ–ãƒ­ã‚°ã‚«ãƒ¼ãƒ‰æ©Ÿèƒ½ï¼ˆã‚·ãƒ§ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹è‡ªå‹•ç”Ÿæˆï¼‰
            
            è¨˜äº‹å†…ã®ä»»æ„ã®å ´æ‰€ã«ãƒ–ãƒ­ã‚°ã‚«ãƒ¼ãƒ‰ã‚’æŒ¿å…¥ã§ãã¾ã™ã€‚URLã‹ã‚‰è‡ªå‹•ã§ã‚¿ã‚¤ãƒˆãƒ«ã€ç”»åƒã€èª¬æ˜æ–‡ã‚’å–å¾—ã—ã¦ãƒ–ãƒ­ã‚°ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆï¼š
            
            ```html
            <p>è©³ã—ã„æ‰‹é †ã«ã¤ã„ã¦ã¯ã€ã“ã¡ã‚‰ã®è¨˜äº‹ã‚‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚</p>
            
            <!-- è¨˜äº‹å†…ã«ãƒ–ãƒ­ã‚°ã‚«ãƒ¼ãƒ‰ã‚’æŒ¿å…¥ -->
            [blog_card url="https://example.com/related-article"]
            
            <p>ä¸Šè¨˜ã®æ–¹æ³•ã‚’è©¦ã—ãŸå¾Œã§ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã¿ã¾ã™ã€‚</p>
            ```
            
            **ã‚·ãƒ§ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼š**
            - `url`: ãƒ–ãƒ­ã‚°ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ãŸã„ãƒšãƒ¼ã‚¸ã®URLï¼ˆå¿…é ˆï¼‰
            
            **ä½¿ç”¨ä¸Šã®æ³¨æ„ï¼š**
            - WordPressãŒè‡ªå‹•çš„ã«URLã‹ã‚‰ãƒ¡ã‚¿æƒ…å ±ã‚’å–å¾—ã—ã¦ã‚«ãƒ¼ãƒ‰åŒ–
            - é–¢é€£è¨˜äº‹ã¸ã®å†…éƒ¨ãƒªãƒ³ã‚¯ã‚„å‚è€ƒè³‡æ–™ã¸ã®å¤–éƒ¨ãƒªãƒ³ã‚¯ã«æ´»ç”¨
            - è¨˜äº‹ã®æµã‚Œã‚’å¦¨ã’ãªã„é©åˆ‡ãªä½ç½®ã«é…ç½®
            
            ### 8. ç”»åƒã®ä½¿ç”¨ä¾‹ï¼ˆaltå±æ€§å¿…é ˆï¼‰ãƒ»ç”»åƒæŒ¿å…¥ã®è¦ä»¶ï¼ˆé‡è¦ï¼‰
            
            **å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«é©åˆ‡ãªä½ç½®ã§ç”»åƒã‚’æŒ¿å…¥ã—ã¦ãã ã•ã„ã€‚ç‰¹ã«ä»¥ä¸‹ã®ç®‡æ‰€ã§ã¯å¿…é ˆï¼š**
            - ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒï¼šè¨˜äº‹ã®å†’é ­éƒ¨åˆ†ï¼ˆãƒªãƒ¼ãƒ‰æ–‡ã®å¾Œï¼‰
            - å„ä¸»è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆH2è¦‹å‡ºã—ï¼‰ï¼šå†…å®¹ã®ç†è§£ã‚’åŠ©ã‘ã‚‹èª¬æ˜ç”»åƒ
            
            ```html
            <figure class="article-content-image">
              <img src="[ç”»åƒç”Ÿæˆäºˆå®šä½ç½®]" alt="[ç”»åƒã®è©³ç´°ãªèª¬æ˜]" loading="lazy" decoding="async" width="800" height="600">
              <figcaption>[ç”»åƒã®ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³]</figcaption>
            </figure>
            ```
            
            **ç”»åƒã®é…ç½®ãƒ«ãƒ¼ãƒ«**ï¼š
            - æœ€ä½4-5ç®‡æ‰€ã«ç”»åƒãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’é…ç½®
            - srcå±æ€§ã«ã¯ `[ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒ]` `[ã‚»ã‚¯ã‚·ãƒ§ãƒ³1ç”»åƒ]` `[ã‚»ã‚¯ã‚·ãƒ§ãƒ³2ç”»åƒ]` ãªã©ã€ã©ã®ä½ç½®ã®ç”»åƒã‹ã‚ã‹ã‚‹ä»®ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥ã‚Œã‚‹
            - altå±æ€§ã«ã¯ãã®ç”»åƒã§è¡¨ç¾ã™ã¹ãå†…å®¹ã‚’è©³ç´°ã«è¨˜è¿°
            - ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã¯ç”»åƒã®è£œè¶³èª¬æ˜ã‚’è¨˜è¼‰
            
            **ç”»åƒã®å¿…é ˆå±æ€§ï¼š**
            - `alt`: ç”»åƒã®ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆï¼ˆå¿…é ˆãƒ»ç©ºã§ã‚‚è¨­å®šï¼‰
            - `width`/`height`: ç”»åƒã‚µã‚¤ã‚ºï¼ˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚·ãƒ•ãƒˆé˜²æ­¢ï¼‰
            - `loading="lazy"`: é…å»¶èª­ã¿è¾¼ã¿ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šï¼‰
            - `decoding="async"`: éåŒæœŸãƒ‡ã‚³ãƒ¼ãƒ‰ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šï¼‰
            
            ### 9. ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰ã®ä½¿ç”¨ä¾‹
            
            ```html
            <div class="review-cards-section">
              <div class="review-card">
                <div class="review-avatar">
                  <img src="avatar.jpg" alt="30ä»£/ä¼šç¤¾å“¡">
                </div>
                <div class="review-content">
                  <h3 class="review-author">30ä»£/ä¼šç¤¾å“¡</h3>
                  <p class="review-text">ã¨ã¦ã‚‚æº€è¶³ã—ã¦ã„ã¾ã™ã€‚ã‚¹ã‚¿ãƒƒãƒ•ã®å¯¾å¿œã‚‚ä¸å¯§ã§ã€ã¾ãŸåˆ©ç”¨ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚</p>
                </div>
              </div>
            </div>
            ```
            
            ### 10. CTAã‚»ã‚¯ã‚·ãƒ§ãƒ³
            
            ```html
            <section class="article-cta-section">
              <h2>ã€è¨˜äº‹ãƒ†ãƒ¼ãƒã«åˆã‚ã›ãŸè¡Œå‹•å–šèµ·ã‚¿ã‚¤ãƒˆãƒ«ã€‘</h2>
              <p>ã€è¨˜äº‹å†…å®¹ã‚’è¸ã¾ãˆãŸèª˜å°æ–‡ã€‘</p>
              <a href="https://beauty.hotpepper.jp/kr/slnH000618948/" class="article-cta-button">ã”äºˆç´„ã¯ã“ã¡ã‚‰</a>
            </section>
            ```
            
            ## ç”Ÿæˆã®æŒ‡ç¤º
            
            ä»¥ä¸‹ã®æ‰‹é †ã§è¨˜äº‹ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ï¼š
            
            1. <strong>å¿…ãšWriteãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦</strong> `output/${{ needs.initialize.outputs.article_id }}/final_article.html` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã§æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
            2. ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã€`<div class="article-content">` ã§é–‹å§‹ã— `</div>` ã§çµ‚äº†ã™ã‚‹å®Œå…¨ãªHTMLã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãè¾¼ã‚€
            3. ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆ`<style>`ã‚¿ã‚°ï¼‰ã¯å«ã‚ãªã„
            
            <strong>é‡è¦</strong>: ãƒ•ã‚¡ã‚¤ãƒ«åã¯å¿…ãš `final_article.html` ã¨ã—ã€ãƒ‘ã‚¹ã¯ `output/${{ needs.initialize.outputs.article_id }}/` é…ä¸‹ã«é…ç½®ã—ã¦ãã ã•ã„ã€‚
            
            **ç”»åƒæŒ¿å…¥ã®å¿…é ˆè¦ä»¶**ï¼š
            1. ç”»åƒãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ï¼ˆ`<figure class="article-content-image">`ï¼‰ã‚’æœ€ä½4-5ç®‡æ‰€é…ç½®
            2. ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒã¯è¨˜äº‹å†’é ­ã«å¿…é ˆ
            3. å„ä¸»è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆH2ï¼‰ã«æœ€ä½1ã¤ã®ç”»åƒã‚’é…ç½®
            4. ç”»åƒã®altå±æ€§ã¨ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã¯å…·ä½“çš„ã§æ„å‘³ã®ã‚ã‚‹å†…å®¹ã«ã™ã‚‹
            5. srcå±æ€§ã«ã¯ `[ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒ]` `[ã‚»ã‚¯ã‚·ãƒ§ãƒ³1ç”»åƒ]` ãªã©ä½ç½®ãŒã‚ã‹ã‚‹ä»®ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨˜è¼‰
            
            æ–‡å­—æ•°ã¯Phase 2ã§æ±ºå®šã—ãŸé…åˆ†ã«å¾“ã„ã€ç·æ–‡å­—æ•°: ${{ inputs.word_count }}Â±300æ–‡å­—ã‚’éµå®ˆã—ã¦ãã ã•ã„ã€‚
            
            ## å“è³ªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆã‚¨ãƒ©ãƒ¼é˜²æ­¢é‡ç‚¹é …ç›®ï¼‰
            
            ### å¿…é ˆãƒã‚§ãƒƒã‚¯é …ç›®ï¼š
            - <strong>ARTICLE-TEMPLATE-README.mdä»•æ§˜ã«å®Œå…¨æº–æ‹ </strong>
            - Phase 2ã®æ§‹æˆé€šã‚Šã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹æˆ
            - ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãªHTMLæ§‹é€ 
            - <strong>ç”»åƒãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ãŒæœ€ä½4-5ç®‡æ‰€ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹</strong>
            - <strong>ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒãŒè¨˜äº‹å†’é ­ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹</strong>
            - <strong>å„ä¸»è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆH2ï¼‰ã«ç”»åƒãŒé…ç½®ã•ã‚Œã¦ã„ã‚‹</strong>
            
            ### HTMLã‚¿ã‚°ã®æ•´åˆæ€§ï¼ˆã‚¨ãƒ©ãƒ¼é˜²æ­¢ï¼‰ï¼š
            - **ä¸€æ„ã®IDè¨­å®š**: ã™ã¹ã¦ã®inputã‚¿ã‚°ã«ä¸€æ„ã®IDã‚’è¨­å®šï¼ˆfaq1, faq2, faq3...ï¼‰
            - **IDå¯¾å¿œç¢ºèª**: labelã®forå±æ€§ã¨inputã®idã‚’å®Œå…¨ä¸€è‡´ã•ã›ã‚‹
            - **ã‚¿ã‚°ã®é–‹å§‹ãƒ»çµ‚äº†**: divã‚¿ã‚°ã‚„sectionã‚¿ã‚°ã®é–‹å§‹ãƒ»çµ‚äº†ã‚’æ­£ç¢ºã«å¯¾å¿œã•ã›ã‚‹
            - **IDé‡è¤‡ç¦æ­¢**: åŒã˜idã‚’è¤‡æ•°å›ä½¿ç”¨ã—ãªã„
            - **ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ**: `<div class="article-content">`ãŒ1ã¤ã®è¨˜äº‹ã«1ã¤ã®ã¿
            
            ### ã‚¹ã‚¿ã‚¤ãƒ«ä»•æ§˜ã®éµå®ˆï¼š
            - strongã‚¿ã‚°ã®é©åˆ‡ãªä½¿ç”¨ï¼ˆæ–‡ç« å†…ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆã®ã¿ã€ãƒ©ãƒ™ãƒ«ã«ã¯ä½¿ç”¨ç¦æ­¢ï¼‰
            - ãƒã‚¤ãƒ©ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ã®åˆ¶é™éµå®ˆï¼ˆ**1ã‚»ã‚¯ã‚·ãƒ§ãƒ³1å€‹ã¾ã§å³å®ˆ**ï¼‰
            - FAQã®æ§‹é€ ãŒæ¨™æº–ä»•æ§˜é€šã‚Šï¼ˆcheckbox + label + spanã€IDé‡è¤‡ãªã—ï¼‰
            - åŸºæœ¬æ§‹æˆã¯h3è¦‹å‡ºã— + pãƒ†ã‚­ã‚¹ãƒˆã®ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹é€ 
            
            ### ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å“è³ªï¼š
            - ã‚¢ãƒ³ã‚«ãƒ¼ãƒªãƒ³ã‚¯ãŒæ­£ã—ãæ©Ÿèƒ½ã™ã‚‹ç›®æ¬¡
            - ãƒªã‚µãƒ¼ãƒçµæœã‹ã‚‰5ã¤ä»¥ä¸Šã®å‡ºå…¸ã‚’å¼•ç”¨
            - å‡ºå…¸ãƒªãƒ³ã‚¯ã®å½¢å¼ãŒæ­£ã—ã„ï¼ˆfn-1, fnref-1ç­‰ï¼‰
            - CTAãŒè¨˜äº‹å†…å®¹ã«æœ€é©åŒ–ã•ã‚Œã¦ã„ã‚‹
            - æŒ‡å®šæ–‡å­—æ•°ã‚’éµå®ˆ
            - ãƒšãƒ«ã‚½ãƒŠã«æœ€é©åŒ–ã•ã‚ŒãŸè¡¨ç¾
            - è–¬æ©Ÿæ³•ãƒ»æ™¯è¡¨æ³•ã«é…æ…®ã—ãŸè¡¨ç¾
          
          allowed_tools: |
            Read,
            Write,
            Edit
          
          claude_env: |
            ARTICLE_ID=${{ needs.initialize.outputs.article_id }}
            TITLE=${{ inputs.article_title }}
            APPROACH_TARGET=${{ inputs.approach_target }}
            MAIN_KEYWORDS=${{ inputs.main_keywords }}
            WORD_COUNT=${{ inputs.word_count }}
          
          max_turns: "15"

      - name: Verify article generation with fallback
        id: verify-article
        run: |
          ARTICLE_DIR="output/${{ needs.initialize.outputs.article_id }}"
          echo "ğŸ” Checking for generated article file..."
          
          if [ -f "$ARTICLE_DIR/final_article.html" ]; then
            echo "âœ… Found final_article.html"
            echo "article_found=true" >> $GITHUB_OUTPUT
            echo "fallback_used=false" >> $GITHUB_OUTPUT
          else
            echo "âš ï¸ Primary generation failed, checking for fallback..."
            echo "ğŸ“ Contents of $ARTICLE_DIR:"
            ls -la "$ARTICLE_DIR/" || echo "Directory not found"
            
            # Check if any HTML file exists
            if [ -f "$ARTICLE_DIR/article.html" ]; then
              mv "$ARTICLE_DIR/article.html" "$ARTICLE_DIR/final_article.html"
              echo "âœ… Found article.html, renamed to final_article.html"
              echo "article_found=true" >> $GITHUB_OUTPUT
              echo "fallback_used=false" >> $GITHUB_OUTPUT
            else
              echo "âŒ ERROR: No HTML article generated!"
              echo "article_found=false" >> $GITHUB_OUTPUT
              exit 1
            fi
          fi

      - name: Upload content artifacts
        uses: actions/upload-artifact@v4
        with:
          name: content-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}
          retention-days: 30

  # ã‚¸ãƒ§ãƒ–7: ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯ï¼ˆå“è³ªã‚¹ã‚³ã‚¢ä»˜ãï¼‰
  factcheck:
    needs: [initialize, generate-content]
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 15
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download artifacts
        uses: actions/download-artifact@v4
        with:
          pattern: '*-${{ needs.initialize.outputs.article_id }}'
          path: output/${{ needs.initialize.outputs.article_id }}
          merge-multiple: true

      - name: Debug - Check files before factcheck
        run: |
          echo "ğŸ“ Files before factcheck:"
          ls -la output/${{ needs.initialize.outputs.article_id }}/
          echo ""
          echo "ğŸ”§ Environment variables:"
          echo "ARTICLE_ID: ${{ needs.initialize.outputs.article_id }}"
          echo "WORKSPACE: ${{ github.workspace }}"
          echo "Expected factcheck path: ${{ github.workspace }}/output/${{ needs.initialize.outputs.article_id }}/factcheck_report.json"
          echo ""
          echo "ğŸ“„ Checking final_article.md:"
          if [ -f "output/${{ needs.initialize.outputs.article_id }}/final_article.md" ]; then
            echo "âœ… final_article.md exists"
            wc -l output/${{ needs.initialize.outputs.article_id }}/final_article.md
          else
            echo "âŒ final_article.md NOT found"
          fi
          echo ""
          echo "ğŸ“„ Checking research_results.json:"
          if [ -f "output/${{ needs.initialize.outputs.article_id }}/research_results.json" ]; then
            echo "âœ… research_results.json exists"
            wc -l output/${{ needs.initialize.outputs.article_id }}/research_results.json
          else
            echo "âŒ research_results.json NOT found"
          fi

      - name: Fact-check article with Claude
        uses: anthropics/claude-code-base-action@beta
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          
          prompt: |
            # è¨˜äº‹ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯ãƒ»å“è³ªã‚¹ã‚³ã‚¢ç®—å‡º
            
            è¨˜äº‹ã®ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯ã‚’è¡Œã„ã€å“è³ªã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã—ã¦ãã ã•ã„ã€‚
            
            ## ã‚¿ã‚¹ã‚¯
            
            ã¾ãšã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§å†…å®¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
            - output/${{ needs.initialize.outputs.article_id }}/final_article.html: è¨˜äº‹æœ¬æ–‡
            - output/${{ needs.initialize.outputs.article_id }}/research_results.json: ãƒªã‚µãƒ¼ãƒçµæœ
            
            ## ãƒã‚§ãƒƒã‚¯è¦³ç‚¹
            
            ### 1. äº‹å®Ÿã®æ­£ç¢ºæ€§
            - è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹æ•°å€¤ãƒ»çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®æ­£ç¢ºæ€§
            - ãƒªã‚µãƒ¼ãƒçµæœã¨ã®æ•´åˆæ€§
            - å‡ºå…¸ã®ä¿¡é ¼æ€§
            
            ### 2. è–¬æ©Ÿæ³•ãƒ»æ™¯è¡¨æ³•ã®éµå®ˆ
            - åŠ¹æœãƒ»åŠ¹èƒ½ã®éåº¦ãªè¡¨ç¾ãŒãªã„ã‹
            - ã€Œå¿…ãšã€ã€Œçµ¶å¯¾ã€ãªã©ã®æ–­å®šçš„è¡¨ç¾ã®ç¢ºèª
            - åŒ»å­¦çš„æ ¹æ‹ ã®ãªã„ä¸»å¼µãŒãªã„ã‹
            
            ### 3. ç§‘å­¦çš„ãƒ»åŒ»å­¦çš„å¦¥å½“æ€§
            - å°‚é–€çš„ä¸»å¼µã®æ ¹æ‹ ã®æœ‰ç„¡
            - æœ€æ–°ã®ç ”ç©¶çµæœã¨ã®æ•´åˆæ€§
            - èª¤è§£ã‚’æ‹›ãè¡¨ç¾ãŒãªã„ã‹
            
            ### 4. ãƒšãƒ«ã‚½ãƒŠã¸ã®é…æ…®
            - ãƒšãƒ«ã‚½ãƒŠãŒèª¤è§£ã—ã‚„ã™ã„è¡¨ç¾ã¯ãªã„ã‹
            - ã‚ˆã‚Šåˆ†ã‹ã‚Šã‚„ã™ã„èª¬æ˜ãŒå¿…è¦ãªç®‡æ‰€ã¯ãªã„ã‹
            
            ### 5. ARTICLE-TEMPLATE-README.mdä»•æ§˜æº–æ‹ ï¼ˆå®Œå…¨ãƒã‚§ãƒƒã‚¯ï¼‰
            
            **HTMLã‚¿ã‚°ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼š**
            - ã™ã¹ã¦ã®inputã‚¿ã‚°ã«ä¸€æ„ã®IDãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆfaq1, faq2, faq3...ï¼‰
            - labelã®forå±æ€§ã¨inputã®idãŒå®Œå…¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹
            - åŒã˜idãŒè¤‡æ•°å›ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‹ï¼ˆIDé‡è¤‡ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ï¼‰
            - divã‚¿ã‚°ã‚„sectionã‚¿ã‚°ã®é–‹å§‹ãƒ»çµ‚äº†ãŒæ­£ã—ãå¯¾å¿œã—ã¦ã„ã‚‹ã‹
            - `<div class="article-content">`ãŒ1ã¤ã®è¨˜äº‹ã«1ã¤ã®ã¿ã‹
            
            **ã‚¹ã‚¿ã‚¤ãƒ«ä»•æ§˜ãƒã‚§ãƒƒã‚¯ï¼š**
            - CSSã‚¯ãƒ©ã‚¹åãŒä»•æ§˜é€šã‚Šã‹
            - strongã‚¿ã‚°ã®ä½¿ç”¨ãŒé©åˆ‡ã‹ï¼ˆæ–‡ç« å†…ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆã®ã¿ã€ãƒ©ãƒ™ãƒ«ã«ã¯ä¸ä½¿ç”¨ï¼‰
            - ãƒã‚¤ãƒ©ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹ãŒ**1ã‚»ã‚¯ã‚·ãƒ§ãƒ³1å€‹ä»¥å†…ã‚’å³å®ˆ**ã—ã¦ã„ã‚‹ã‹
            - FAQã®æ§‹é€ ãŒæ­£ã—ã„ã‹ï¼ˆcheckbox + label + spanã€è³ªå•æ–‡ãŒspanè¦ç´ ã§å›²ã¾ã‚Œã¦ã„ã‚‹ã‹ï¼‰
            - å‡ºå…¸ãƒªãƒ³ã‚¯ã®å½¢å¼ãŒæ­£ã—ã„ã‹ï¼ˆfn-1, fnref-1ç­‰ã®ç›¸äº’ãƒªãƒ³ã‚¯ï¼‰
            - åŸºæœ¬æ§‹æˆãŒh3è¦‹å‡ºã— + pãƒ†ã‚­ã‚¹ãƒˆã®ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹é€ ã«ãªã£ã¦ã„ã‚‹ã‹
            
            ## å‡ºåŠ›å½¢å¼
            
            ### 1. è¨˜äº‹ã®å†…å®¹ã‚’ãƒã‚§ãƒƒã‚¯
            ä¸Šè¨˜5ã¤ã®è¦³ç‚¹ã§è©³ç´°ã«ç¢ºèªã—ã€å•é¡Œç®‡æ‰€ãŒã‚ã‚Œã°å…·ä½“çš„ã«æŒ‡æ‘˜ã—ã¦ãã ã•ã„ã€‚
            
            ### 2. ä¿®æ­£ãŒå¿…è¦ãªå ´åˆ
            output/${{ needs.initialize.outputs.article_id }}/final_article.html ã‚’ç›´æ¥ç·¨é›†ã—ã€ä¿®æ­£ç†ç”±ã‚’æ˜è¨˜ã—ã¦ãã ã•ã„ã€‚
            
            ### 3. å“è³ªãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆ
            output/${{ needs.initialize.outputs.article_id }}/factcheck_report.json ã¨ã—ã¦ä»¥ä¸‹ã®JSONå½¢å¼ã§ä¿å­˜ï¼š
            
            ```json
            {
              "overall_quality_score": 85,
              "fact_accuracy_score": 90,
              "legal_compliance_score": 95,
              "scientific_validity_score": 80,
              "source_reliability_score": 85,
              "issues_found": [
                {
                  "type": "fact_error|legal_compliance|scientific_validity|clarity",
                  "description": "å…·ä½“çš„ãªå•é¡Œã®èª¬æ˜",
                  "location": "è¨˜äº‹å†…ã®è©²å½“ç®‡æ‰€ï¼ˆè¦‹å‡ºã—ã‚„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‰",
                  "severity": "high|medium|low",
                  "corrected": true,
                  "correction_detail": "ã©ã®ã‚ˆã†ã«ä¿®æ­£ã—ãŸã‹ã®èª¬æ˜"
                }
              ],
              "recommendations": [
                "ã‚ˆã‚Šå…·ä½“çš„ãªçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ ã‚’æ¨å¥¨",
                "å°‚é–€ç”¨èªã®èª¬æ˜ã‚’ã‚‚ã†å°‘ã—è©³ã—ã"
              ],
              "strengths": [
                "ä¿¡é ¼ã§ãã‚‹å‡ºå…¸ã‚’5ã¤ä»¥ä¸Šå¼•ç”¨",
                "ãƒšãƒ«ã‚½ãƒŠã«åˆã‚ã›ãŸåˆ†ã‹ã‚Šã‚„ã™ã„è¡¨ç¾"
              ],
              "timestamp": "ç¾åœ¨æ™‚åˆ»",
              "total_issues": 3,
              "corrected_issues": 2,
              "factcheck_summary": "è¨˜äº‹å…¨ä½“ã®å“è³ªã«ã¤ã„ã¦ã®ç·åˆã‚³ãƒ¡ãƒ³ãƒˆ"
            }
            ```
            
            ## ã‚¹ã‚³ã‚¢åŸºæº–
            - **overall_quality_score** (0-100): ç·åˆå“è³ªã‚¹ã‚³ã‚¢
            - **fact_accuracy_score** (0-100): äº‹å®Ÿã®æ­£ç¢ºæ€§
            - **legal_compliance_score** (0-100): è–¬æ©Ÿæ³•ãƒ»æ™¯è¡¨æ³•éµå®ˆåº¦
            - **scientific_validity_score** (0-100): ç§‘å­¦çš„ãƒ»åŒ»å­¦çš„å¦¥å½“æ€§
            - **source_reliability_score** (0-100): æƒ…å ±æºã®ä¿¡é ¼æ€§
            
            ## æ³¨æ„ç‚¹
            - **å®¢è¦³çš„ãªè©•ä¾¡**: æ„Ÿæƒ…çš„ãªåˆ¤æ–­ã§ã¯ãªãã€äº‹å®Ÿã«åŸºã¥ã„ã¦è©•ä¾¡
            - **å»ºè¨­çš„ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: å•é¡Œç‚¹ã ã‘ã§ãªãæ”¹å–„æ¡ˆã‚‚æç¤º
            - **ãƒšãƒ«ã‚½ãƒŠè¦–ç‚¹**: èª­è€…ï¼ˆãƒšãƒ«ã‚½ãƒŠï¼‰ã®ç†è§£ã—ã‚„ã™ã•ã‚’é‡è¦–
            - **æ³•è¦åˆ¶ã®ç†è§£**: å¥åº·ãƒ»ç¾å®¹åˆ†é‡ã®è¡¨ç¾è¦åˆ¶ã‚’æ­£ã—ãé©ç”¨
          
          allowed_tools: |
            Read,
            Write,
            Edit
          
          claude_env: |
            ARTICLE_ID=${{ needs.initialize.outputs.article_id }}
            WORKSPACE=${{ github.workspace }}
          
          max_turns: "10"

      - name: Debug - Check Claude execution
        run: |
          echo "ğŸ” Post-Claude execution check:"
          echo "Working directory: $(pwd)"
          echo ""
          echo "ğŸ“ All files in output directory after Claude:"
          ls -la output/${{ needs.initialize.outputs.article_id }}/
          echo ""
          echo "ğŸ” Looking for any JSON files created:"
          find output/${{ needs.initialize.outputs.article_id }}/ -name "*.json" -type f

      - name: Verify factcheck output
        run: |
          echo "ğŸ” Checking factcheck output..."
          if [ -f "output/${{ needs.initialize.outputs.article_id }}/factcheck_report.json" ]; then
            echo "âœ… factcheck_report.json created successfully"
            ls -la output/${{ needs.initialize.outputs.article_id }}/factcheck_report.json
          else
            echo "âŒ factcheck_report.json NOT found!"
            echo "ğŸ“ Contents of output directory:"
            ls -la output/${{ needs.initialize.outputs.article_id }}/ || echo "Directory not found"
          fi

      - name: Upload factcheck artifacts
        uses: actions/upload-artifact@v4
        with:
          name: factcheck-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}
          retention-days: 30

  # ã‚¸ãƒ§ãƒ–8: SEOãƒ¡ã‚¿æƒ…å ±ç”Ÿæˆ
  generate-seo-meta:
    needs: [initialize, analysis, generate-content]
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 10
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download artifacts
        uses: actions/download-artifact@v4
        with:
          pattern: '*-${{ needs.initialize.outputs.article_id }}'
          path: output/${{ needs.initialize.outputs.article_id }}
          merge-multiple: true

      - name: Debug - Check files before SEO
        run: |
          echo "ğŸ“ Files before SEO metadata generation:"
          ls -la output/${{ needs.initialize.outputs.article_id }}/
          echo ""
          echo "ğŸ”§ Environment variables:"
          echo "ARTICLE_ID: ${{ needs.initialize.outputs.article_id }}"
          echo "WORKSPACE: ${{ github.workspace }}"
          echo "Expected SEO path: ${{ github.workspace }}/output/${{ needs.initialize.outputs.article_id }}/seo_metadata.json"
          echo ""
          echo "ğŸ“„ Checking required files:"
          for file in final_article.md input_params.json phase1_output.json; do
            if [ -f "output/${{ needs.initialize.outputs.article_id }}/$file" ]; then
              echo "âœ… $file exists"
            else
              echo "âŒ $file NOT found"
            fi
          done

      - name: Generate SEO metadata with Claude
        uses: anthropics/claude-code-base-action@beta
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          
          prompt: |
            # SEOãƒ¡ã‚¿æƒ…å ±ç”Ÿæˆ
            
            è¨˜äº‹ã®SEOãƒ¡ã‚¿æƒ…å ±ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
            
            ## å…¥åŠ›æƒ…å ±
            
            ### å®Œæˆè¨˜äº‹
            output/${{ needs.initialize.outputs.article_id }}/final_article.html ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„ï¼ˆPhase 4ã§ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯æ¸ˆã¿ã®æœ€çµ‚HTMLè¨˜äº‹ï¼‰
            
            ### åŸºæœ¬æƒ…å ±
            - **è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«**: ${{ inputs.article_title }}
            - **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ«ã‚½ãƒŠ**: ${{ inputs.approach_target }}
            - **ç›®æ¨™æ–‡å­—æ•°**: ${{ inputs.word_count }}
            
            ### Phase 1ã®åˆ†æçµæœ
            output/${{ needs.initialize.outputs.article_id }}/phase1_output.json ã‹ã‚‰ä»¥ä¸‹ã®é …ç›®ã‚’å‚ç…§ï¼š
            - **ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰**: main_keyword
            - **é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰**: related_keywords
            - **æ¤œç´¢æ„å›³**: search_intent
            - **ãƒ¡ã‚¿ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰**: ${{ inputs.main_keywords }}
            
            ## ã‚¿ã‚¹ã‚¯
            
            ã¾ãšã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§å†…å®¹ã‚’ç†è§£ã—ã¦ãã ã•ã„ï¼š
            - output/${{ needs.initialize.outputs.article_id }}/final_article.html: è¨˜äº‹æœ¬æ–‡
            - output/${{ needs.initialize.outputs.article_id }}/phase1_output.json: åˆ†æçµæœ
            
            è¨˜äº‹å†…å®¹ã‚’åˆ†æã—ã€SEOã«æœ€é©åŒ–ã•ã‚ŒãŸãƒ¡ã‚¿æƒ…å ±ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
            
            ### 1. è¨˜äº‹å†…å®¹ã®åˆ†æ
            - å®Ÿéš›ã®æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
            - ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å‡ºç¾é »åº¦ã®ç¢ºèª
            - ä¸»è¦ãªãƒã‚¤ãƒ³ãƒˆã®æŠ½å‡º
            - èª­äº†æ™‚é–“ã®æ¨å®š
            
            ### 2. SEOãƒ¡ã‚¿æƒ…å ±ã®ç”Ÿæˆ
            output/${{ needs.initialize.outputs.article_id }}/seo_metadata.json ã¨ã—ã¦ä»¥ä¸‹ã®JSONå½¢å¼ã§ä¿å­˜ï¼š
            
            ```json
            {
              "title": "è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆ60æ–‡å­—ä»¥å†…ã€æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³è¡¨ç¤ºç”¨ï¼‰",
              "meta_description": "è¨˜äº‹ã®è¦ç´„ï¼ˆ120-160æ–‡å­—ã€æ¤œç´¢çµæœã«è¡¨ç¤ºã•ã‚Œã‚‹èª¬æ˜æ–‡ï¼‰",
              "meta_keywords": ["ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰1", "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰2", "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰3", "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰4", "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰5"],
              "og_title": "SNSç”¨ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆè¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«ã¨åŒã˜ã‹ã€ã‚ˆã‚Šé­…åŠ›çš„ã«èª¿æ•´ï¼‰",
              "og_description": "SNSç”¨èª¬æ˜æ–‡ï¼ˆmeta_descriptionã¨åŒã˜ã‹èª¿æ•´ç‰ˆï¼‰",
              "focus_keyword": "æœ€ã‚‚é‡è¦ãªãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰",
              "secondary_keywords": ["ã‚µãƒ–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰1", "ã‚µãƒ–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰2", "ã‚µãƒ–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰3"],
              "keyword_density": {
                "ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰": 2.8,
                "ã‚µãƒ–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰1": 1.5,
                "ã‚µãƒ–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰2": 1.2
              },
              "schema_type": "Article",
              "estimated_reading_time": "5åˆ†",
              "actual_word_count": 3150,
              "seo_analysis": {
                "title_optimization": "æ¤œç´¢æ„å›³ã«åˆè‡´ã€æ–‡å­—æ•°é©åˆ‡",
                "keyword_distribution": "è‡ªç„¶ãªé…ç½®ã€éåº¦ãªè©°ã‚è¾¼ã¿ãªã—",
                "content_quality": "é«˜å“è³ªã€E-E-A-TåŸå‰‡ã«æº–æ‹ "
              },
              "created_at": "ç¾åœ¨æ™‚åˆ»"
            }
            ```
            
            ### 3. SEOæœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ
            
            <strong>ãƒ¡ã‚¿ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆtitleï¼‰ï¼š</strong>
            - 60æ–‡å­—ä»¥å†…
            - ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å‰åŠã«é…ç½®
            - ã‚¯ãƒªãƒƒã‚¯ã—ãŸããªã‚‹é­…åŠ›çš„ãªè¡¨ç¾
            - ãƒšãƒ«ã‚½ãƒŠã®æ¤œç´¢æ„å›³ã«åˆè‡´
            
            <strong>ãƒ¡ã‚¿ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ï¼š</strong>
            - 120-160æ–‡å­—
            - è¨˜äº‹ã®ä¾¡å€¤ã‚’æ˜ç¢ºã«ä¼ãˆã‚‹
            - è¡Œå‹•ã‚’ä¿ƒã™è¡¨ç¾ï¼ˆã€Œã€‡ã€‡ã®æ–¹æ³•ã‚’è§£èª¬ã€ãªã©ï¼‰
            - è‡ªç„¶ã«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚ã‚‹
            
            <strong>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æˆ¦ç•¥ï¼š</strong>
            - ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å¯†åº¦: 2-4%
            - é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®è‡ªç„¶ãªé…ç½®
            - LSIã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆé–¢é€£èªï¼‰ã®æ´»ç”¨
            
            <strong>OGPè¨­å®šï¼š</strong>
            - SNSã§ã®è¦‹æ „ãˆã‚’è€ƒæ…®
            - è¦–è¦šçš„ã«ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®ã‚ã‚‹è¡¨ç¾
            
            ### 4. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¯†åº¦è¨ˆç®—æ–¹æ³•
            ```
            ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¯†åº¦(%) = (ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å‡ºç¾å›æ•° / ç·å˜èªæ•°) Ã— 100
            ```
            
            ## æ³¨æ„ç‚¹
            
            1. **è‡ªç„¶ãªæ—¥æœ¬èª**: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ç„¡ç†ã«è©°ã‚è¾¼ã¾ãªã„
            2. **ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦–ç‚¹**: æ¤œç´¢è€…ãŒæ±‚ã‚ã‚‹æƒ…å ±ã‚’æ˜ç¢ºã«ç¤ºã™
            3. **ç«¶åˆå·®åˆ¥åŒ–**: ä»–è¨˜äº‹ã¨ã®å·®åˆ¥åŒ–ãƒã‚¤ãƒ³ãƒˆã‚’å¼·èª¿
            4. **E-E-A-T**: å°‚é–€æ€§ãƒ»æ¨©å¨æ€§ãƒ»ä¿¡é ¼æ€§ã‚’æ„è­˜
            5. **ãƒšãƒ«ã‚½ãƒŠæœ€é©åŒ–**: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå±¤ã«éŸ¿ãè¡¨ç¾ã‚’é¸æŠ
          
          allowed_tools: |
            Read,
            Write
          
          claude_env: |
            ARTICLE_ID=${{ needs.initialize.outputs.article_id }}
            WORD_COUNT=${{ inputs.word_count }}
            WORKSPACE=${{ github.workspace }}
          
          max_turns: "30"

      - name: Debug - Check Claude execution for SEO
        run: |
          echo "ğŸ” Post-Claude SEO execution check:"
          echo "Working directory: $(pwd)"
          echo ""
          echo "ğŸ“ All files in output directory after Claude SEO:"
          ls -la output/${{ needs.initialize.outputs.article_id }}/
          echo ""
          echo "ğŸ” Looking for any JSON files created:"
          find output/${{ needs.initialize.outputs.article_id }}/ -name "*.json" -type f

      - name: Verify SEO metadata output
        run: |
          echo "ğŸ” Checking SEO metadata output..."
          if [ -f "output/${{ needs.initialize.outputs.article_id }}/seo_metadata.json" ]; then
            echo "âœ… seo_metadata.json created successfully"
            ls -la output/${{ needs.initialize.outputs.article_id }}/seo_metadata.json
          else
            echo "âŒ seo_metadata.json NOT found!"
            echo "ğŸ“ Contents of output directory:"
            ls -la output/${{ needs.initialize.outputs.article_id }}/ || echo "Directory not found"
          fi

      - name: Upload SEO metadata artifacts
        uses: actions/upload-artifact@v4
        with:
          name: seo-meta-${{ needs.initialize.outputs.article_id }}
          path: output/${{ needs.initialize.outputs.article_id }}
          retention-days: 30

  # ã‚¸ãƒ§ãƒ–9: ç”»åƒç”Ÿæˆï¼ˆMCP + Imagen4ï¼‰
  generate-images:
    if: ${{ inputs.enable_image_generation }}
    needs: [initialize, generate-structure]
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 20
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download artifacts
        uses: actions/download-artifact@v4
        with:
          pattern: '*-${{ needs.initialize.outputs.article_id }}'
          path: output/${{ needs.initialize.outputs.article_id }}
          merge-multiple: true

      - name: Generate Images with Claude + MCP Imagen4
        uses: anthropics/claude-code-base-action@beta
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          
          prompt: |
            è¨˜äº‹ã«æœ€é©ãªç”»åƒã‚’è¤‡æ•°æšç”Ÿæˆã—ã¦ãã ã•ã„ã€‚åˆè¨ˆ4-5æšã®ç”»åƒã‚’ç”Ÿæˆã—ã¾ã™ã€‚
            
            ã‚¿ã‚¹ã‚¯:
            1. è¨˜äº‹å†…å®¹ã‚’ç†è§£:
               - input_params.json ã§ãƒšãƒ«ã‚½ãƒŠã‚’ç¢ºèª
               - final_article.md ã§è¨˜äº‹å†…å®¹ã‚’æŠŠæ¡ï¼ˆã‚ã‚Œã°ï¼‰
               - 01_article_structure.md ã§æ§‹æˆã‚’ç†è§£
            
            2. ä»¥ä¸‹ã®æ‰‹é †ã§å€‹åˆ¥ã«ç”»åƒã‚’ç”Ÿæˆ:
               
               **ã‚¹ãƒ†ãƒƒãƒ—1**: ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒï¼ˆ16:9ï¼‰ã‚’ç”Ÿæˆ
               - mcp__gemini-imagen__generate_image ã‚’ä½¿ç”¨
               - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: "è¨˜äº‹å…¨ä½“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’è¡¨ç¾ã™ã‚‹16:9ã®ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒ"
               - ãƒšãƒ«ã‚½ãƒŠã«åˆã‚ã›ãŸãƒ¡ã‚¤ãƒ³ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«
               
               **ã‚¹ãƒ†ãƒƒãƒ—2**: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”»åƒ1ï¼ˆ4:3ï¼‰ã‚’ç”Ÿæˆ  
               - mcp__gemini-imagen__generate_image ã‚’ä½¿ç”¨
               - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: "è¨˜äº‹ã®å°å…¥éƒ¨åˆ†ã‚’è¡¨ç¾ã™ã‚‹4:3ã®ç”»åƒ"
               
               **ã‚¹ãƒ†ãƒƒãƒ—3**: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”»åƒ2ï¼ˆ4:3ï¼‰ã‚’ç”Ÿæˆ
               - mcp__gemini-imagen__generate_image ã‚’ä½¿ç”¨  
               - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: "è¨˜äº‹ã®æ–¹æ³•ãƒ»æ‰‹é †éƒ¨åˆ†ã‚’è¡¨ç¾ã™ã‚‹4:3ã®ç”»åƒ"
               
               **ã‚¹ãƒ†ãƒƒãƒ—4**: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”»åƒ3ï¼ˆ4:3ï¼‰ã‚’ç”Ÿæˆ
               - mcp__gemini-imagen__generate_image ã‚’ä½¿ç”¨
               - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: "è¨˜äº‹ã®çµæœãƒ»åŠ¹æœéƒ¨åˆ†ã‚’è¡¨ç¾ã™ã‚‹4:3ã®ç”»åƒ"
               
               **ã‚¹ãƒ†ãƒƒãƒ—5**: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”»åƒ4ï¼ˆ4:3ï¼‰ã‚’ç”Ÿæˆ
               - mcp__gemini-imagen__generate_image ã‚’ä½¿ç”¨
               - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: "è¨˜äº‹ã®ã¾ã¨ã‚éƒ¨åˆ†ã‚’è¡¨ç¾ã™ã‚‹4:3ã®ç”»åƒ"
            
            3. ç”»åƒç”Ÿæˆã®æ–¹é‡ï¼ˆå…¨ç”»åƒå…±é€šï¼‰:
               - ãƒšãƒ«ã‚½ãƒŠã®å¹´ä»£ãƒ»æ€§åˆ¥ã«åˆã‚ã›ãŸãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«
               - æ¸…æ½”æ„Ÿã¨ä¿¡é ¼æ„Ÿã®ã‚ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³
               - è¨˜äº‹å†…å®¹ã¨èª¿å’Œã—ãŸã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
               - ãƒ†ã‚­ã‚¹ãƒˆã‚„ãƒ­ã‚´ã¯å«ã¾ãªã„
               - imagen-4 ã¾ãŸã¯ imagen-4-ultra ã‚’ä½¿ç”¨
            
            4. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä½œæˆ:
               - images/metadata.json ã«ç”Ÿæˆæƒ…å ±ã‚’è¨˜éŒ²
               - å„ç”»åƒã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ç”¨é€”ã€ã‚µã‚¤ã‚ºã‚’è¨˜è¼‰
               
            é‡è¦: å¿…ãš5å›ã®mcp__gemini-imagen__generate_imageã‚’å®Ÿè¡Œã—ã¦ã€è¤‡æ•°æšã®ç”»åƒã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
          
          mcp_config: |
            {
              "mcpServers": {
                "gemini-imagen": {
                  "command": "npx",
                  "args": [
                    "-y", 
                    "gemini-imagen-mcp-server",
                    "--model", "imagen-4"
                  ],
                  "env": {
                    "GEMINI_API_KEY": "${{ secrets.GEMINI_API_KEY }}"
                  }
                }
              }
            }
          
          allowed_tools: |
            Read,
            Write,
            mcp__gemini-imagen__generate_image,
            mcp__gemini-imagen__list_models
          
          claude_env: |
            ARTICLE_ID=${{ needs.initialize.outputs.article_id }}
          
          max_turns: "30"

      - name: Process generated images
        run: |
          ARTICLE_DIR="output/${{ needs.initialize.outputs.article_id }}"
          IMAGE_DIR="${ARTICLE_DIR}/images"
          
          # MCPã‚µãƒ¼ãƒãƒ¼ã¯ imagen/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã™ã‚‹
          if [ -d "imagen" ] && [ "$(ls -A imagen 2>/dev/null)" ]; then
            echo "âœ… Images found in imagen directory:"
            ls -la imagen/
            
            # ç”»åƒã‚’è¨˜äº‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼
            mkdir -p $IMAGE_DIR
            cp imagen/*.png $IMAGE_DIR/ 2>/dev/null || true
            cp imagen/*.jpg $IMAGE_DIR/ 2>/dev/null || true
            
            # ãƒªãƒãƒ¼ãƒ ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
            cd $IMAGE_DIR
            i=1
            for img in *.png *.jpg; do
              if [ -f "$img" ]; then
                if [ $i -eq 1 ]; then
                  mv "$img" "hero_image.png" 2>/dev/null || true
                else
                  mv "$img" "section_$((i-1))_image.png" 2>/dev/null || true
                fi
                i=$((i+1))
              fi
            done
            cd -
            
            echo "Final images:"
            ls -la $IMAGE_DIR
          else
            echo "âš ï¸ No images generated"
          fi

      - name: Upload image artifacts
        uses: actions/upload-artifact@v4
        with:
          name: images-${{ needs.initialize.outputs.article_id }}
          path: |
            output/${{ needs.initialize.outputs.article_id }}/images
            imagen/
          retention-days: 30

  # ã‚¸ãƒ§ãƒ–10: æœ€çµ‚å‡¦ç†ï¼ˆ5ã¤ã®æˆæœç‰©ï¼‰
  finalize:
    needs: [initialize, analysis, research-merge, generate-structure, generate-content, factcheck, generate-seo-meta, generate-images]
    if: always()
    runs-on: ubuntu-latest
    environment: GA
    timeout-minutes: 10
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download all artifacts
        uses: actions/download-artifact@v4
        with:
          pattern: '*-${{ needs.initialize.outputs.article_id }}'
          path: output/${{ needs.initialize.outputs.article_id }}
          merge-multiple: true

      - name: Create final package with Claude
        uses: anthropics/claude-code-base-action@beta
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          
          prompt: |
            # æœ€çµ‚ã¾ã¨ã‚ãƒ»æˆæœç‰©æ•´ç†
            
            V4è¨˜äº‹ç”Ÿæˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æœ€çµ‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆã—ã€5ã¤ã®ä¸»è¦æˆæœç‰©ã‚’æ•´ç†ã—ã¦ãã ã•ã„ã€‚
            
            ## å…¥åŠ›æƒ…å ±
            
            ### Phase 1ã®æˆæœç‰©
            output/${{ needs.initialize.outputs.article_id }}/phase1_output.json ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„
            
            ### Phase 2ã®æˆæœç‰©
            ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„ï¼š
            - output/${{ needs.initialize.outputs.article_id }}/01_article_structure.md: è¨˜äº‹æ§‹æˆ
            - output/${{ needs.initialize.outputs.article_id }}/02_content_plan.md: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¨ˆç”»
            
            ### Phase 3ã®æˆæœç‰©
            output/${{ needs.initialize.outputs.article_id }}/final_article.html ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„
            
            ### Phase 4ã®æˆæœç‰©
            output/${{ needs.initialize.outputs.article_id }}/factcheck_report.json ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„
            
            ### Phase 5ã®æˆæœç‰©
            output/${{ needs.initialize.outputs.article_id }}/seo_metadata.json ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„
            
            ### ãƒªã‚µãƒ¼ãƒæƒ…å ±ï¼ˆã¾ã¨ã‚ç”¨ï¼‰
            output/${{ needs.initialize.outputs.article_id }}/research_results.json ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„
            
            ## ã‚¿ã‚¹ã‚¯
            
            ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å‡ºåŠ›ã¨åŒç­‰ã®ã‚¯ã‚ªãƒªãƒ†ã‚£ã§ã€ä»¥ä¸‹ã®æˆæœç‰©ã‚’æ•´ç†ãƒ»ã¾ã¨ã‚ã¦ãã ã•ã„ã€‚
            
            ### 1. æœ€çµ‚æˆæœç‰©ãƒªã‚¹ãƒˆï¼ˆV4æº–æ‹ ï¼‰
            
            <strong>5ã¤ã®ä¸»è¦æˆæœç‰©:</strong>
            1. <strong>research_results.json</strong> - ãƒªã‚µãƒ¼ãƒçµæœï¼ˆä¿¡é ¼æ€§ã‚¹ã‚³ã‚¢ä»˜ãï¼‰
            2. <strong>factcheck_report.json</strong> - ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯å“è³ªã‚¹ã‚³ã‚¢
            3. <strong>seo_metadata.json</strong> - SEOãƒ¡ã‚¿æƒ…å ±
            4. <strong>final_article.html</strong> - æœ€çµ‚è¨˜äº‹ï¼ˆHTMLå½¢å¼ï¼‰
            5. <strong>deliverables_summary.md</strong> - æˆæœç‰©èª¬æ˜æ›¸
            
            ### 2. research_results.json ã®ç¢ºèªã¨æ•´ç†
            æ—¢å­˜ã®research_results.jsonãŒé©åˆ‡ãªå½¢å¼ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ä»¥ä¸‹ã®å½¢å¼ã«æ•´ç†ï¼š
            
            ```json
            {
              "research_data": [
                {
                  "query": "ãƒªã‚µãƒ¼ãƒã‚¯ã‚¨ãƒª",
                  "results": [
                    {
                      "title": "æƒ…å ±æºã®ã‚¿ã‚¤ãƒˆãƒ«",
                      "url": "https://example.com",
                      "summary": "è¦ç´„ã•ã‚ŒãŸå†…å®¹",
                      "reliability_score": 85,
                      "source_type": "academic|news|official|blog",
                      "publication_date": "2024-01-01",
                      "relevance_score": 90
                    }
                  ]
                }
              ],
              "research_summary": {
                "total_sources": 15,
                "average_reliability": 82,
                "key_findings": [
                  "é‡è¦ãªç™ºè¦‹1",
                  "é‡è¦ãªç™ºè¦‹2",
                  "é‡è¦ãªç™ºè¦‹3"
                ],
                "research_gaps": [
                  "æ›´ãªã‚‹èª¿æŸ»ãŒå¿…è¦ãªç‚¹"
                ]
              },
              "created_at": "ç¾åœ¨æ™‚åˆ»"
            }
            ```
            
            ### 3. deliverables_summary.md ã®ä½œæˆ
            
            output/${{ needs.initialize.outputs.article_id }}/deliverables_summary.md ã¨ã—ã¦ä»¥ä¸‹ã®å½¢å¼ã§ä½œæˆï¼š
            
            ```markdown
            # V4è¨˜äº‹ç”Ÿæˆå®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ
            
            ## åŸºæœ¬æƒ…å ±
            - <strong>è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«</strong>: ${{ inputs.article_title }}
            - <strong>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ«ã‚½ãƒŠ</strong>: ${{ inputs.approach_target }}
            - <strong>ç”Ÿæˆæ—¥æ™‚</strong>: [ç¾åœ¨æ—¥æ™‚]
            - <strong>ç·æ–‡å­—æ•°</strong>: [å®Ÿéš›ã®æ–‡å­—æ•°]æ–‡å­—
            
            ## æˆæœç‰©æ¦‚è¦
            
            ### 1. final_article.html - æœ€çµ‚è¨˜äº‹
            - <strong>å½¢å¼</strong>: HTMLï¼ˆ<div class="article-content">å½¢å¼ï¼‰
            - <strong>ç‰¹å¾´</strong>: 
              - ãƒšãƒ«ã‚½ãƒŠæœ€é©åŒ–æ¸ˆã¿
              - å‡ºå…¸ãƒªãƒ³ã‚¯ä»˜ãï¼ˆ5ã¤ä»¥ä¸Šï¼‰
              - è–¬æ©Ÿæ³•ãƒ»æ™¯è¡¨æ³•å¯¾å¿œ
              - CTAæœ€é©åŒ–æ¸ˆã¿
            
            ### 2. research_results.json - ãƒªã‚µãƒ¼ãƒçµæœ
            - <strong>åé›†ã‚½ãƒ¼ã‚¹æ•°</strong>: [å®Ÿéš›ã®æ•°]ä»¶
            - <strong>å¹³å‡ä¿¡é ¼æ€§ã‚¹ã‚³ã‚¢</strong>: [å®Ÿéš›ã®ã‚¹ã‚³ã‚¢]ç‚¹
            - <strong>ä¸»è¦ç™ºè¦‹</strong>: 
              - [å®Ÿéš›ã®ç™ºè¦‹ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—]
            
            ### 3. factcheck_report.json - å“è³ªã‚¹ã‚³ã‚¢
            - <strong>ç·åˆå“è³ªã‚¹ã‚³ã‚¢</strong>: [å®Ÿéš›ã®ã‚¹ã‚³ã‚¢]ç‚¹/100ç‚¹
            - <strong>äº‹å®Ÿæ­£ç¢ºæ€§</strong>: [å®Ÿéš›ã®ã‚¹ã‚³ã‚¢]ç‚¹/100ç‚¹
            - <strong>æ³•è¦åˆ¶éµå®ˆ</strong>: [å®Ÿéš›ã®ã‚¹ã‚³ã‚¢]ç‚¹/100ç‚¹
            - <strong>ç§‘å­¦çš„å¦¥å½“æ€§</strong>: [å®Ÿéš›ã®ã‚¹ã‚³ã‚¢]ç‚¹/100ç‚¹
            - <strong>ä¿®æ­£ç®‡æ‰€</strong>: [å®Ÿéš›ã®æ•°]ä»¶ï¼ˆå…¨ã¦å¯¾å¿œæ¸ˆã¿ï¼‰
            
            ### 4. seo_metadata.json - SEOæƒ…å ±
            - <strong>ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</strong>: [å®Ÿéš›ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰]
            - <strong>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¯†åº¦</strong>: [å®Ÿéš›ã®å¯†åº¦]%ï¼ˆé©æ­£ç¯„å›²ï¼‰
            - <strong>ãƒ¡ã‚¿ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³</strong>: æœ€é©åŒ–æ¸ˆã¿ï¼ˆ[å®Ÿéš›ã®æ–‡å­—æ•°]æ–‡å­—ï¼‰
            - <strong>æ¨å®šèª­äº†æ™‚é–“</strong>: [å®Ÿéš›ã®æ™‚é–“]åˆ†
            
            ### 5. ç”»åƒé…ç½®æƒ…å ±
            - <strong>ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒ</strong>: ã‚»ã‚¯ã‚·ãƒ§ãƒ³å°å…¥ç”¨
            - <strong>ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”»åƒ</strong>: å„ä¸»è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«é…ç½®
            - <strong>èª¬æ˜ç”»åƒ</strong>: æ‰‹é †ãƒ»æ–¹æ³•ã®è¦–è¦šçš„èª¬æ˜ç”¨
            - <strong>ç·ç”»åƒæ•°</strong>: [å®Ÿéš›ã®æ•°]æšï¼ˆè¨˜äº‹å†…é…ç½®æ¸ˆã¿ï¼‰
            
            ## å“è³ªè©•ä¾¡ã‚µãƒãƒªãƒ¼
            
            ### å¼·ã¿
            - [Phase 4ã§è©•ä¾¡ã•ã‚ŒãŸå®Ÿéš›ã®å¼·ã¿ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—]
            
            ### æ”¹å–„å¯¾å¿œ
            - [å®Ÿéš›ã«ä¿®æ­£ã•ã‚ŒãŸå•é¡Œç‚¹ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—]
            
            ## ãƒšãƒ«ã‚½ãƒŠæœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ
            - **è¨€è‘‰é£ã„**: [ãƒšãƒ«ã‚½ãƒŠã«åˆã‚ã›ãŸè¡¨ç¾ãƒ¬ãƒ™ãƒ«]
            - **å†…å®¹æ·±åº¦**: [ãƒšãƒ«ã‚½ãƒŠã®çŸ¥è­˜ãƒ¬ãƒ™ãƒ«ã«é©åˆ]
            - **é–¢å¿ƒé ˜åŸŸ**: [ãƒšãƒ«ã‚½ãƒŠã®èˆˆå‘³ãƒ»æ‚©ã¿ã«å¯¾å¿œ]
            - **è¡Œå‹•å–šèµ·**: [ãƒšãƒ«ã‚½ãƒŠã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã«æœ€é©åŒ–]
            
            ## SEOæœ€é©åŒ–ã‚µãƒãƒªãƒ¼
            - **æ¤œç´¢æ„å›³**: [æ¤œç´¢æ„å›³] ã«æœ€é©åŒ–
            - **ç«¶åˆå„ªä½æ€§**: [ä»–è¨˜äº‹ã¨ã®å·®åˆ¥åŒ–ãƒã‚¤ãƒ³ãƒˆ]
            - **E-E-A-Tå¯¾å¿œ**: å°‚é–€æ€§ãƒ»æ¨©å¨æ€§ãƒ»ä¿¡é ¼æ€§ã‚’ç¢ºä¿
            
            ## æ³•è¦åˆ¶å¯¾å¿œ
            - **è–¬æ©Ÿæ³•**: åŠ¹æœåŠ¹èƒ½ã®é©åˆ‡ãªè¡¨ç¾
            - **æ™¯è¡¨æ³•**: å„ªè‰¯èª¤èªã®é˜²æ­¢
            - **è¡¨ç¾èª¿æ•´**: [å…·ä½“çš„ãªèª¿æ•´å†…å®¹]
            
            ## æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆæ¨å¥¨ï¼‰
            1. **å…¬é–‹å‰ç¢ºèª**: æœ€çµ‚çš„ãªæ ¡æ­£ãƒ»ç¢ºèª
            2. **ç”»åƒæœ€é©åŒ–**: altå±æ€§ã¨ãƒ•ã‚¡ã‚¤ãƒ«åã®æœ€é©åŒ–
            3. **å†…éƒ¨ãƒªãƒ³ã‚¯**: é–¢é€£è¨˜äº‹ã¨ã®é€£æº
            4. **åŠ¹æœæ¸¬å®š**: å…¬é–‹å¾Œã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ
            
            ## åˆ¶ä½œãƒãƒ¼ãƒˆ
            - **åˆ¶ä½œæ™‚é–“**: ç´„[X]æ™‚é–“ï¼ˆ6ãƒ•ã‚§ãƒ¼ã‚ºï¼‰
            - **ä¿®æ­£å›æ•°**: [å®Ÿéš›ã®å›æ•°]å›
            - **ç‰¹è¨˜äº‹é …**: [ç‰¹åˆ¥ãªé…æ…®äº‹é …ãŒã‚ã‚Œã°è¨˜è¼‰]
            ```
            
            ## å“è³ªä¿è¨¼ãƒã‚§ãƒƒã‚¯
            
            ### æˆæœç‰©ã®å®Œå…¨æ€§ç¢ºèª
            - 5ã¤ã®ä¸»è¦æˆæœç‰©ãŒå…¨ã¦æƒã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
            - JSONãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ãŒæ­£ã—ã„ã“ã¨ã‚’ç¢ºèª
            - HTMLã®æ§‹é€ ãŒæ­£ã—ã„ã“ã¨ã‚’ç¢ºèª
            - ãƒªãƒ³ã‚¯ãŒæ­£ã—ãæ©Ÿèƒ½ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
            - æ–‡å­—æ•°ãŒè¦ä»¶ã‚’æº€ãŸã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
            
            ### å†…å®¹ã®ä¸€è²«æ€§ç¢ºèª
            - å…¨ãƒ•ã‚§ãƒ¼ã‚ºã®å†…å®¹ãŒæ•´åˆã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
            - ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è²«ã—ã¦ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
            - ãƒšãƒ«ã‚½ãƒŠè¨­å®šãŒå…¨ä½“ã§çµ±ä¸€ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
            - å“è³ªåŸºæº–ã‚’æº€ãŸã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
            
            ## æ³¨æ„ç‚¹
            - å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
            - ã‚¹ã‚³ã‚¢ã‚„çµ±è¨ˆã¯å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æŠ½å‡ºã—ã¦è¨˜è¼‰
            - ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ï¼ˆ[å®Ÿéš›ã®ã€œ]ï¼‰ã¯å®Ÿéš›ã®å€¤ã«ç½®ãæ›ãˆã‚‹
            - ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯å‰Šé™¤ã—ãªã„ï¼ˆåˆ¶ä½œå´ã§é¸æŠï¼‰
          
          allowed_tools: |
            Read,
            Write,
            Edit
          
          claude_env: |
            ARTICLE_ID=${{ needs.initialize.outputs.article_id }}
          
          max_turns: "10"

      # Google Drive upload removed - using GitHub Artifacts only

      - name: Create workflow summary
        if: always()
        run: |
          ARTICLE_DIR="output/${{ needs.initialize.outputs.article_id }}"
          
          echo "## ğŸ“ Article Generation V4 Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ğŸ“‹ Input Parameters" >> $GITHUB_STEP_SUMMARY
          echo "- <strong>Title</strong>: ${{ inputs.article_title }}" >> $GITHUB_STEP_SUMMARY
          echo "- <strong>åˆ‡ã‚Šå£ãƒ»ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ</strong>: ${{ inputs.approach_target }}" >> $GITHUB_STEP_SUMMARY
          echo "- <strong>ä¸»è¦KW</strong>: ${{ inputs.main_keywords }}" >> $GITHUB_STEP_SUMMARY
          echo "- <strong>E-E-A-Tè¦ç´ </strong>: ${{ inputs.eeat_elements }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          echo "### ğŸ¯ V4 Deliverables" >> $GITHUB_STEP_SUMMARY
          echo "1. <strong>research_results.json</strong> - Research data with reliability scores" >> $GITHUB_STEP_SUMMARY
          echo "2. <strong>factcheck_report.json</strong> - Quality scores and fact-checking results" >> $GITHUB_STEP_SUMMARY
          echo "3. <strong>seo_metadata.json</strong> - SEO metadata (keywords, meta description, etc.)" >> $GITHUB_STEP_SUMMARY
          echo "4. <strong>images/</strong> - Generated images (hero + section images)" >> $GITHUB_STEP_SUMMARY  
          echo "5. <strong>final_article.html</strong> - HTML article with embedded images" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          if [ -f "$ARTICLE_DIR/V4_deliverables.md" ]; then
            echo "### ğŸ“Š Generation Summary" >> $GITHUB_STEP_SUMMARY
            cat "$ARTICLE_DIR/V4_deliverables.md" >> $GITHUB_STEP_SUMMARY
          fi
          
          if [ -d "$ARTICLE_DIR/images" ]; then
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "### ğŸ–¼ï¸ Generated Images" >> $GITHUB_STEP_SUMMARY
            echo "- Image count: $(find $ARTICLE_DIR/images -name "*.png" -o -name "*.jpg" | wc -l)" >> $GITHUB_STEP_SUMMARY
          fi

      - name: Create organized final package
        run: |
          ARTICLE_DIR="output/${{ needs.initialize.outputs.article_id }}"
          FINAL_DIR="final_package"
          
          # è©³ç´°ãƒ‡ãƒãƒƒã‚°: ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
          echo "====== FINAL PACKAGE CREATION DEBUG ======"
          echo "ğŸ” ARTICLE_DIR: $ARTICLE_DIR"
          echo "ğŸ“ Article directory check:"
          [ -d "$ARTICLE_DIR" ] && echo "âœ… Directory exists" || echo "âŒ Directory NOT found"
          
          echo ""
          echo "ğŸ“‹ All downloaded artifacts and files:"
          find . -name "*.json" -o -name "*.md" -o -name "*.png" -o -name "*.jpg" | head -20
          
          echo ""
          echo "ğŸ–¼ï¸ Specifically looking for images:"
          echo "PNG files:"
          find . -name "*.png" -type f 2>/dev/null | head -10
          echo "JPG files:"
          find . -name "*.jpg" -o -name "*.jpeg" -type f 2>/dev/null | head -10
          echo ""
          echo "Image directories:"
          find . -name "images" -type d 2>/dev/null
          find . -name "imagen" -type d 2>/dev/null
          
          echo ""
          echo "ğŸ” Current working directory contents:"
          ls -la
          
          echo ""
          echo "ğŸ” Specifically looking for factcheck and SEO files:"
          echo "Factcheck files:"
          find . -name "*factcheck*" -type f 2>/dev/null || echo "No factcheck files found"
          echo "SEO files:"
          find . -name "*seo*" -type f 2>/dev/null || echo "No SEO files found"
          
          echo ""
          echo "ğŸ” Output directory contents:"
          if [ -d "output/" ]; then
            find output/ -type f | head -20
          else
            echo "âŒ No output directory found"
          fi
          
          echo "=============================================="
          
          # æœ€çµ‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
          mkdir -p $FINAL_DIR
          
          # V4ã®4ã¤ã®æˆæœç‰©ã‚’åé›†ï¼ˆã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‹ã‚‰ç›´æ¥ï¼‰
          echo ""
          echo "ğŸ”„ Collecting V4 deliverables from artifacts..."
          
          # 1. ãƒ¡ã‚¤ãƒ³è¨˜äº‹ (HTML) - ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‹ã‚‰æ¤œç´¢
          ARTICLE_FOUND=false
          
          # è¤‡æ•°ã®å ´æ‰€ã‹ã‚‰è¨˜äº‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢
          POSSIBLE_ARTICLES=(
            "$ARTICLE_DIR/final_article.html"
            "$ARTICLE_DIR/article.html"
            "final_article.html"
            "article.html"
          )
          
          for article_path in "${POSSIBLE_ARTICLES[@]}"; do
            if [ -f "$article_path" ]; then
              cp "$article_path" "$FINAL_DIR/article.html"
              echo "âœ… Found and copied article: $article_path ($(wc -c < "$article_path") bytes)"
              ARTICLE_FOUND=true
              break
            fi
          done
          
          # è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯.htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢
          if [ "$ARTICLE_FOUND" = false ]; then
            echo "âš ï¸ Standard article files not found, searching for any .html files..."
            HTML_FILE=$(find . -name "*.html" -type f ! -name "index.html" | head -1)
            if [ -n "$HTML_FILE" ]; then
              cp "$HTML_FILE" "$FINAL_DIR/article.html"
              echo "âœ… Using fallback .html file: $HTML_FILE ($(wc -c < "$HTML_FILE") bytes)"
              ARTICLE_FOUND=true
            fi
          fi
          
          if [ "$ARTICLE_FOUND" = false ]; then
            echo "âŒ ERROR: No article file found in any location!"
            echo "Creating minimal article as last resort..."
            echo '<div class="article-content"><h2>è¨˜äº‹ç”Ÿæˆã‚¨ãƒ©ãƒ¼</h2><p>è¨˜äº‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡Œãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p></div>' > "$FINAL_DIR/article.html"
          fi
          
          # 2. ãƒªã‚µãƒ¼ãƒçµæœ - è¤‡æ•°ã®å ´æ‰€ã‹ã‚‰æ¤œç´¢
          RESEARCH_LOCATIONS=(
            "$ARTICLE_DIR/research_results.json"
            "research_results.json"
            "research-*.json"
          )
          
          RESEARCH_FOUND=false
          for loc in "${RESEARCH_LOCATIONS[@]}"; do
            if [ -f "$loc" ]; then
              cp "$loc" "$FINAL_DIR/research_results.json"
              echo "âœ… Found research results: $loc"
              RESEARCH_FOUND=true
              break
            fi
          done
          
          if [ "$RESEARCH_FOUND" = false ]; then
            # æ¤œç´¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨
            RESEARCH_FILE=$(find . -name "*research*.json" | head -1)
            if [ -n "$RESEARCH_FILE" ]; then
              cp "$RESEARCH_FILE" "$FINAL_DIR/research_results.json"
              echo "âœ… Using research file: $RESEARCH_FILE"
            else
              echo "âš ï¸ No research results found"
            fi
          fi
          
          # 3. SEOãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ - è¤‡æ•°ã®å ´æ‰€ã‹ã‚‰æ¤œç´¢
          SEO_LOCATIONS=(
            "$ARTICLE_DIR/seo_metadata.json"
            "seo_metadata.json"
            "seo-*.json"
          )
          
          SEO_FOUND=false
          for loc in "${SEO_LOCATIONS[@]}"; do
            if [ -f "$loc" ]; then
              cp "$loc" "$FINAL_DIR/seo_metadata.json"
              echo "âœ… Found SEO metadata: $loc"
              SEO_FOUND=true
              break
            fi
          done
          
          if [ "$SEO_FOUND" = false ]; then
            echo "âš ï¸ No SEO metadata found"
            echo "ğŸ“ Searching for SEO metadata files..."
            find . -name "*seo*.json" -type f 2>/dev/null | head -10
          fi
          
          # 4. ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯å“è³ªãƒ¬ãƒãƒ¼ãƒˆ - è¤‡æ•°ã®å ´æ‰€ã‹ã‚‰æ¤œç´¢
          FACTCHECK_LOCATIONS=(
            "$ARTICLE_DIR/factcheck_report.json"
            "factcheck_report.json"
            "factcheck-*.json"
          )
          
          FACTCHECK_FOUND=false
          for loc in "${FACTCHECK_LOCATIONS[@]}"; do
            if [ -f "$loc" ]; then
              cp "$loc" "$FINAL_DIR/factcheck_report.json"
              echo "âœ… Found factcheck report: $loc"
              FACTCHECK_FOUND=true
              break
            fi
          done
          
          if [ "$FACTCHECK_FOUND" = false ]; then
            # æ¤œç´¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨
            FACTCHECK_FILE=$(find . -name "*factcheck*.json" | head -1)
            if [ -n "$FACTCHECK_FILE" ]; then
              cp "$FACTCHECK_FILE" "$FINAL_DIR/factcheck_report.json"
              echo "âœ… Using factcheck file: $FACTCHECK_FILE"
            else
              echo "âš ï¸ No factcheck report found"
              echo "ğŸ“ Searching for factcheck files..."
              find . -name "*factcheck*.json" -type f 2>/dev/null | head -10
            fi
          fi
          
          # 5. ç”»åƒãƒ•ã‚©ãƒ«ãƒ€ - è¤‡æ•°ã®å ´æ‰€ã‹ã‚‰æ¤œç´¢
          mkdir -p "$FINAL_DIR/images"
          IMAGES_FOUND=false
          
          # æ¨™æº–çš„ãªç”»åƒãƒ•ã‚©ãƒ«ãƒ€ã®å ´æ‰€
          if [ -d "$ARTICLE_DIR/images" ]; then
            cp -r "$ARTICLE_DIR/images/"* "$FINAL_DIR/images/" 2>/dev/null || true
            echo "âœ… Found images in $ARTICLE_DIR/images"
            IMAGES_FOUND=true
          fi
          
          # imagen/ ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ç”»åƒã‚’æ¤œç´¢ï¼ˆMCPç”»åƒç”Ÿæˆã®å ´æ‰€ï¼‰
          if [ -d "imagen" ]; then
            echo "ğŸ“ Checking imagen/ directory for MCP generated images..."
            cp imagen/*.png "$FINAL_DIR/images/" 2>/dev/null || true
            cp imagen/*.jpg "$FINAL_DIR/images/" 2>/dev/null || true
            if [ "$(ls -A imagen/*.png 2>/dev/null)" ] || [ "$(ls -A imagen/*.jpg 2>/dev/null)" ]; then
              echo "âœ… Found images in imagen/"
              IMAGES_FOUND=true
            fi
          fi
          
          # images-*/output/*/images/ ã‹ã‚‰ç”»åƒã‚’æ¤œç´¢ï¼ˆã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®æ§‹é€ ï¼‰
          IMAGE_ARTIFACT_PATHS=$(find . -path "*/images-*/output/*/images" -type d 2>/dev/null)
          if [ -n "$IMAGE_ARTIFACT_PATHS" ]; then
            for img_path in $IMAGE_ARTIFACT_PATHS; do
              echo "ğŸ“ Found image artifact path: $img_path"
              cp "$img_path"/*.png "$FINAL_DIR/images/" 2>/dev/null || true
              cp "$img_path"/*.jpg "$FINAL_DIR/images/" 2>/dev/null || true
              IMAGES_FOUND=true
            done
          fi
          
          # ç›´æ¥ output/*/images ã¾ãŸã¯ output/*/imagen ã‹ã‚‰æ¤œç´¢
          if [ -d "$ARTICLE_DIR/images" ] || [ -d "$ARTICLE_DIR/imagen" ]; then
            echo "ğŸ“ Checking output artifact directories..."
            [ -d "$ARTICLE_DIR/images" ] && cp -r "$ARTICLE_DIR/images/"* "$FINAL_DIR/images/" 2>/dev/null || true
            [ -d "$ARTICLE_DIR/imagen" ] && cp -r "$ARTICLE_DIR/imagen/"* "$FINAL_DIR/images/" 2>/dev/null || true
            IMAGES_FOUND=true
          fi
          
          # ãã®ä»–ã®å ´æ‰€ã‹ã‚‰ç”»åƒã‚’æ¤œç´¢ï¼ˆæœ€å¾Œã®æ‰‹æ®µï¼‰
          if [ "$IMAGES_FOUND" = false ]; then
            echo "âš ï¸ Standard image locations not found, searching all directories..."
            find . -name "*.png" -o -name "*.jpg" -o -name "*.jpeg" | while read img; do
              if [[ "$img" != *"README"* ]] && [[ "$img" != *"node_modules"* ]]; then
                cp "$img" "$FINAL_DIR/images/" 2>/dev/null || true
                echo "âœ… Found image: $img"
                IMAGES_FOUND=true
              fi
            done
          fi
          
          # ç”»åƒãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹ã‚’ç¢ºèª
          echo "ğŸ“ Final images directory contents:"
          ls -la "$FINAL_DIR/images/" 2>/dev/null || echo "No images directory created"
          
          
          # V4æˆæœç‰©èª¬æ˜
          if [ -f "$ARTICLE_DIR/V4_deliverables.md" ]; then
            cp "$ARTICLE_DIR/V4_deliverables.md" "$FINAL_DIR/deliverables.md"
          fi
          
          # æœ€çµ‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å†…å®¹ç¢ºèª
          echo ""
          echo "ğŸ“¦ Final package contents:"
          find "$FINAL_DIR" -type f -exec ls -la {} \;
          
          # READMEä½œæˆ
          echo "# V4 è¨˜äº‹ç”Ÿæˆå®Œäº†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆåˆ¶ä½œå‘ã‘ç°¡æ˜“ç‰ˆï¼‰" > "$FINAL_DIR/README.md"
          echo "" >> "$FINAL_DIR/README.md"
          echo "<strong>è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«</strong>: ${{ inputs.article_title }}" >> "$FINAL_DIR/README.md"
          echo "<strong>ç”Ÿæˆæ—¥æ™‚</strong>: $(date +%Y-%m-%d\ %H:%M:%S)" >> "$FINAL_DIR/README.md"
          echo "<strong>è¨˜äº‹ID</strong>: ${{ needs.initialize.outputs.article_id }}" >> "$FINAL_DIR/README.md"
          echo "" >> "$FINAL_DIR/README.md"
          echo "## ğŸ“ V4æˆæœç‰©ï¼ˆ5ç‚¹ï¼‰" >> "$FINAL_DIR/README.md"
          echo "" >> "$FINAL_DIR/README.md"
          echo "1. <strong>article.html</strong> - è¨˜äº‹æœ¬æ–‡ï¼ˆHTMLå½¢å¼ã€ç”»åƒé…ç½®æ¸ˆã¿ï¼‰" >> "$FINAL_DIR/README.md"
          echo "2. <strong>research_results.json</strong> - ãƒªã‚µãƒ¼ãƒçµæœï¼ˆä¿¡é ¼æ€§ã‚¹ã‚³ã‚¢ä»˜ãï¼‰" >> "$FINAL_DIR/README.md"
          echo "3. <strong>factcheck_report.json</strong> - ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯å“è³ªã‚¹ã‚³ã‚¢ï¼ˆ0-100ç‚¹ï¼‰" >> "$FINAL_DIR/README.md"
          echo "4. <strong>seo_metadata.json</strong> - SEOãƒ¡ã‚¿æƒ…å ±ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€ãƒ¡ã‚¿ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç­‰ï¼‰" >> "$FINAL_DIR/README.md"
          echo "5. <strong>images/</strong> - ç”Ÿæˆç”»åƒï¼ˆå„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”¨ï¼‰" >> "$FINAL_DIR/README.md"
          echo "" >> "$FINAL_DIR/README.md"
          echo "## ğŸ¯ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæƒ…å ±" >> "$FINAL_DIR/README.md"
          echo "" >> "$FINAL_DIR/README.md"
          echo "- <strong>åˆ‡ã‚Šå£ãƒ»ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ</strong>: ${{ inputs.approach_target }}" >> "$FINAL_DIR/README.md"
          echo "- <strong>ä¸»è¦KW</strong>: ${{ inputs.main_keywords }}" >> "$FINAL_DIR/README.md"
          echo "- <strong>E-E-A-Tè¦ç´ </strong>: ${{ inputs.eeat_elements }}" >> "$FINAL_DIR/README.md"
          echo "" >> "$FINAL_DIR/README.md"
          echo "## ğŸ“ å‚™è€ƒ" >> "$FINAL_DIR/README.md"
          echo "" >> "$FINAL_DIR/README.md"
          echo "- <strong>article.html</strong>: æŒ‡å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå½¢å¼ã®HTMLï¼ˆ<div class=\"article-content\">ã§é–‹å§‹ï¼‰" >> "$FINAL_DIR/README.md"
          echo "- ç”»åƒã¯å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«é…ç½®æ¸ˆã¿" >> "$FINAL_DIR/README.md"
          echo "- è¿½åŠ ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚„SEOæ§‹é€ åŒ–ãŒå¿…è¦ãªå ´åˆã¯åˆ¶ä½œå´ã§å®Ÿæ–½ã—ã¦ãã ã•ã„" >> "$FINAL_DIR/README.md"
          
          echo "ğŸ“¦ V4 final package created in: $FINAL_DIR"
          ls -la $FINAL_DIR/

      - name: Upload final package
        uses: actions/upload-artifact@v4
        with:
          name: FINAL_V4_ARTICLE_PACKAGE
          path: final_package
          retention-days: 30

