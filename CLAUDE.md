## 絶対に守るべき開発ルール

以下のルールは例外なく厳守すること：

1. **勝手に機能を変更しない** 
   - ユーザーが実装した機能を無断で変更・削除・無効化しない
   - 既存の動作を変える場合は必ず確認を取る
   
2. **ハードコードしない**
   - 固定値や定数をコードに直接埋め込まない
   - 設定可能な値は必ず変数や設定ファイルから読み込む
   - 例: スコア設定の重み、ポイント上限、表示テキストなど
   
3. **一時的な対処をしない**
   - その場しのぎの修正や暫定対応は行わない
   - 根本的な解決策を実装する
   - TODO や FIXME を残さない

4. **作業記録の徹底**
   - 大きな修正を実施した後は必ず `memory_bank/` にレポートを残す
   - フォーマット: `yyyy-mm-dd_機能名.md`
   - 記録内容: 問題の詳細、原因、実施した修正、影響範囲、成果

5. **タスク開始前の確認**
   - 作業開始前に必ず `memory_bank/` の過去の実装ログを確認
   - 関連する過去の修正内容を把握してから作業を開始
   - 同じ問題の再発を防ぐため

6. **他機能への影響を最小化**
   - 修正を行う際は、他の機能に影響を与えないよう細心の注意を払う
   - 影響範囲を明確に把握してから実装
   - テストで動作確認を徹底

7. **影響の大きい修正は事前確認**
   - 他の機能に影響する可能性がある修正は、実施前に必ずユーザーに確認を取る
   - 影響範囲と修正内容を明確に説明
   - 承認を得てから実装を開始

8. **作業前後の徹底**
   - ユーザーから要件を聞いたら作業に入らずまずはultrathinkで要件を理解し `memory_bank/doc` へ要件定義と仕様書を出力
   - フォーマット: `yyyy-mm-dd_機能名.md`
   - ユーザーがok出したら次に `memory_bank/tasks` へタスクを出力、タスクは出来るだけ詳細に分けること
   - 作業前後は必ず上記も確認し実装した内容があっているかを確認すること

9. **作業の効率化**
   - mcp連携しているserenaを使ってコンテキストを効率よく管理すること
   - 不明点があった場合はそのまま進めたり勝手に変更するのではなく必ずユーザーへ質問をすること

10. **開発ルール**
   - 基本的にはTDD開発で堅実にすめること
   - 一時的なテストscriptは一つのディレクトリにまとめる
   - 型エラーやLintエラーには気を付けて、既存のコードをよく見て適切にすすめること
   - any型の使用は禁止
   - 新規実装時は型や関数名を明確にし、\spec ディレクトリへmd形式で記述すること、更新があればここも都度更新をすること
   - mcp serenaを使って効率的に開発をすすめること
   - taskやphase毎にかならずテスト、動作確認をすること

この指示書に従って、システムの実装・保守を行ってください。

## Gemini CLI 連携ガイド

### 目的
ユーザーが **「Geminiと相談しながら進めて」** （または同義語）と指示した場合、Claude は以降のタスクを **Gemini CLI** と協調しながら進める。
Gemini から得た回答はそのまま提示し、Claude 自身の解説・統合も付け加えることで、両エージェントの知見を融合する。

---

### トリガー
- 正規表現: `/Gemini.*相談しながら/`
- 例:
- 「Geminiと相談しながら進めて」
- 「この件、Geminiと話しつつやりましょう」

---

### 基本フロー
1. **PROMPT 生成**
Claude はユーザーの要件を 1 つのテキストにまとめ、環境変数 `$PROMPT` に格納する。

2. **Gemini CLI 呼び出し**
```bash
gemini <<EOF
$PROMPT
EOF

### エージェント
- "C:\Users\ikeik\.claude\agents"
- 適切にagentsを使用し質の高い開発をすすめること。


## GPT-5連携機能

  このプロジェクトではMCP (Model Context Protocol)を通じてGPT-5と連携できる環境が構築されています。

  ### 使用方法

  以下のフレーズを使用すると、自動的にGPT-5（gpt5ツール）と連携して作業を進めます：

  - **「ぽるかと協力して進めて」**
  - **「ぽるかに相談して進めて」**
  - **「ぽるかの意見も聞いて」**
  - **「ぽるかに確認して」**

  ### 連携時の動作

  上記のフレーズが含まれる指示を受けた場合：

  1. **自動的にsk_gpt5ツールを使用**してGPT-5に問い合わせます
  2. タスクの内容に応じて、GPT-5から以下のような支援を受けます：
     - コード実装の代替案やベストプラクティスの提案
     - アーキテクチャ設計の検討
     - 問題解決のアプローチ提案
     - コードレビューや改善点の指摘

  3. ぽるか(GPT-5)からの回答を踏まえて、より良い解決策を提供します
  4. ぽるか(GPT-5)はあなたの上司です

  ### 具体的な活用例

  - **複雑な実装の相談**: 「この機能の実装方法を上司に相談して進めて」
  - **設計判断の確認**: 「このアーキテクチャ設計について上司の意見も聞いて」
  - **コードレビュー**: 「このコードの改善点を上司と協力して見つけて」
  - **トラブルシューティング**: 「このエラーの解決方法を上司に確認して」

  ### 技術詳細

  - **MCPツール名**: `gpt5`