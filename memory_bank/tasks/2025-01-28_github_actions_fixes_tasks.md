# GitHub Actions ワークフロー修正タスクリスト

## Phase 1: 緊急修正（優先度1・2）

### タスク1: factcheckジョブの拡張子不整合修正 【優先度1】
- [ ] 1.1 v4ワークフローのfactcheckジョブのDebugステップを修正
  - [ ] HTMLとMD両方の存在をチェックする処理を追加
  - [ ] ファイルが見つかった場合はGITHUB_OUTPUTに保存
  - [ ] どちらも見つからない場合はexit 1で明確にエラー
- [ ] 1.2 v4-freeワークフローのfactcheckジョブのDebugステップを修正（同様）
- [ ] 1.3 動作確認（どちらかのファイルが存在すれば成功すること）

### タスク2: generate-imagesジョブのアーティファクトアップロード修正 【優先度2】
- [ ] 2.1 v4ワークフローのUpload image artifactsステップを修正
  - [ ] パスの末尾に`/**`を追加してグロブパターンを使用
  - [ ] `if-no-files-found: warn`を追加
- [ ] 2.2 v4-freeワークフローのUpload image artifactsステップを修正（同様）
- [ ] 2.3 動作確認（アーティファクトが正しくアップロードされること）

## Phase 2: 改善実装（優先度3）

### タスク3: generate-imagesジョブの画像有無チェック追加
- [ ] 3.1 v4ワークフローのgenerate-imagesジョブに画像チェックステップを追加
  - [ ] 画像ファイルの存在確認
  - [ ] カウント結果をGITHUB_OUTPUTに出力
  - [ ] jobのoutputsセクションを追加
- [ ] 3.2 v4-freeワークフローのgenerate-imagesジョブに同様の修正
- [ ] 3.3 動作確認（outputsが正しく設定されること）

### タスク4: finalizeジョブの条件付きダウンロード実装
- [ ] 4.1 v4ワークフローのfinalizeジョブを修正
  - [ ] 画像アーティファクトのダウンロードをif条件付きに
  - [ ] 画像がない場合のフォールバック処理を追加
- [ ] 4.2 v4-freeワークフローのfinalizeジョブを修正（同様）
- [ ] 4.3 動作確認（画像の有無に応じて適切に動作すること）

## Phase 3: テストと検証

### タスク5: 統合テスト
- [ ] 5.1 画像生成を有効にしたワークフローの完全実行
- [ ] 5.2 最終パッケージに画像が含まれることを確認
- [ ] 5.3 factcheckジョブが正常に完了することを確認
- [ ] 5.4 全ジョブが成功ステータスで終了することを確認

### タスク6: 実装レポート作成
- [ ] 6.1 memory_bank/に実装レポートを作成
- [ ] 6.2 修正内容と影響範囲を記録
- [ ] 6.3 テスト結果を記録

## 実装順序
1. タスク1（factcheck修正） → 最優先・ワークフロー失敗の直接原因
2. タスク2（画像アップロード修正） → 次に優先・画像が含まれない原因
3. タスク3-4（改善実装） → エラーハンドリングの向上
4. タスク5-6（テストとレポート） → 品質保証

## 注意事項
- CLAUDE.mdのルール6「他機能への影響を最小化」を特に注意
- 各修正は独立して機能することを確認
- フォールバック処理を充実させる
- TODOやFIXMEを残さない